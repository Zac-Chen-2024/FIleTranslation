<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÁßªÊ∞ëÊùêÊñôÁøªËØë</title>
    <!-- Favicon -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üîÑ</text></svg>" type="image/svg+xml">
    <link rel="apple-touch-icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><rect width='100' height='100' fill='%233b82f6'/><text x='50%' y='50%' dominant-baseline='central' text-anchor='middle' font-size='60' fill='white'>ËØë</text></svg>" type="image/svg+xml">
    <style>
        :root {
            --screen-width: 100vw;
            --screen-height: 100vh;
            --device-pixel-ratio: 1;
            --aspect-ratio: 1.33;
            --base-font-size: 16px;
            --container-padding: 20px;
            --panel-spacing: 15px;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 50%, #0f172a 100%);
            color: #f1f5f9;
            min-height: 100vh;
            overflow-x: hidden;
            line-height: 1.6;
        }

        /* Ê∑ªÂä†Âä®ÊÄÅËÉåÊôØÊïàÊûú */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 20% 50%, rgba(59, 130, 246, 0.08) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(147, 51, 234, 0.08) 0%, transparent 50%),
                radial-gradient(circle at 40% 80%, rgba(16, 185, 129, 0.06) 0%, transparent 50%);
            z-index: -1;
            animation: backgroundShift 20s ease-in-out infinite;
        }

        @keyframes backgroundShift {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.8; }
        }

        .container {
            display: flex;
            min-height: 100vh;
            max-width: 1400px;
            margin: 0 auto;
            backdrop-filter: blur(10px);
            border-radius: 0 0 20px 20px;
            overflow: hidden;
            box-shadow: 
                0 0 50px rgba(59, 130, 246, 0.15),
                inset 0 1px 0 rgba(255, 255, 255, 0.05);
        }

        .left-panel {
            flex: 0 0 450px;
            background: rgba(15, 23, 42, 0.95);
            backdrop-filter: blur(20px);
            padding: 30px;
            border-right: 1px solid rgba(59, 130, 246, 0.2);
            overflow-y: auto;
            position: relative;
        }

        .left-panel::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 2px;
            background: linear-gradient(90deg, 
                transparent,
                rgba(59, 130, 246, 0.6),
                rgba(147, 51, 234, 0.6),
                transparent
            );
        }

        .right-panel {
            flex: 1;
            background: rgba(30, 41, 59, 0.8);
            backdrop-filter: blur(15px);
            padding: 30px;
            display: flex;
            flex-direction: column;
            position: relative;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            position: relative;
        }

        .header h1 {
            background: linear-gradient(135deg, #60a5fa, #a78bfa, #34d399);
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            font-size: 2.4em;
            margin-bottom: 10px;
            font-weight: 700;
            letter-spacing: -0.02em;
            text-shadow: 0 0 30px rgba(59, 130, 246, 0.3);
        }

        .header p {
            color: #cbd5e1;
            font-size: 1.1em;
            font-weight: 400;
            letter-spacing: 0.3px;
        }

        .version-badge {
            display: inline-block;
            background: linear-gradient(135deg, #3b82f6, #1d4ed8);
            color: #ffffff !important;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.6em;
            margin-left: 8px;
            font-weight: 600;
            box-shadow: 
                0 2px 8px rgba(59, 130, 246, 0.4),
                inset 0 1px 0 rgba(255, 255, 255, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.2);
            -webkit-text-fill-color: #ffffff !important;
            background-clip: padding-box !important;
            -webkit-background-clip: padding-box !important;
        }

        .translation-options {
            margin-bottom: 30px;
        }

        .option-group {
            margin-bottom: 25px;
        }

        .option-label {
            font-weight: 600;
            margin-bottom: 15px;
            color: #f8fafc;
            font-size: 1.1em;
            text-transform: uppercase;
            letter-spacing: 1px;
            background: linear-gradient(90deg, #3b82f6, transparent);
            padding: 8px 0;
            border-left: 3px solid #3b82f6;
            padding-left: 12px;
        }

        .sub-label {
            font-weight: 600;
            margin-bottom: 10px;
            color: #f8fafc;
            font-size: 0.95em;
            text-transform: uppercase;
            letter-spacing: 0.8px;
            background: linear-gradient(90deg, rgba(59, 130, 246, 0.6), transparent);
            padding: 6px 0;
            border-left: 2px solid rgba(59, 130, 246, 0.8);
            padding-left: 10px;
            border-radius: 0 4px 4px 0;
        }

        .radio-group {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .radio-item {
            display: flex;
            align-items: center;
            padding: 18px;
            border: 1px solid rgba(59, 130, 246, 0.25);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.1s cubic-bezier(0.4, 0, 0.2, 1);
            background: rgba(15, 23, 42, 0.6);
            backdrop-filter: blur(10px);
            position: relative;
            overflow: hidden;
        }

        .radio-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, 
                transparent, 
                rgba(59, 130, 246, 0.08), 
                transparent
            );
            transition: left 0.3s ease;
        }

        .radio-item:hover::before {
            left: 100%;
        }

        .radio-item:hover {
            border-color: #3b82f6;
            transform: translateY(-2px);
            box-shadow: 
                0 10px 25px rgba(59, 130, 246, 0.15),
                0 0 0 1px rgba(59, 130, 246, 0.1);
            background: rgba(59, 130, 246, 0.03);
        }

        .radio-item.active {
            border-color: #3b82f6;
            background: linear-gradient(135deg, 
                rgba(59, 130, 246, 0.08), 
                rgba(147, 51, 234, 0.03)
            );
            box-shadow: 
                0 0 20px rgba(59, 130, 246, 0.2),
                inset 0 1px 0 rgba(255, 255, 255, 0.05);
        }

        .radio-item input[type="radio"] {
            display: none;
        }

        .radio-item label {
            cursor: pointer;
            font-weight: 500;
            flex: 1;
            color: #f8fafc;
            font-size: 1.05em;
        }

        .radio-item .description {
            font-size: 0.9em;
            color: #cbd5e1;
            margin-top: 4px;
            font-weight: 300;
        }

        .radio-item.active {
            border-color: #3b82f6;
            background: linear-gradient(135deg, 
                rgba(59, 130, 246, 0.25), 
                rgba(147, 51, 234, 0.15)
            );
            box-shadow: 
                0 0 25px rgba(59, 130, 246, 0.4),
                inset 0 1px 0 rgba(255, 255, 255, 0.15);
        }

        .radio-item.active label {
            color: #ffffff;
        }

        .radio-item.active .description {
            color: #e2e8f0;
        }

        .input-section {
            margin-top: 20px;
        }

        .input-group {
            margin-bottom: 20px;
        }

        .input-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #f8fafc;
            text-transform: uppercase;
            font-size: 0.85em;
            letter-spacing: 0.5px;
        }

        .input-group input, .input-group textarea, .input-group select {
            width: 100%;
            padding: 14px 16px;
            border: 1px solid rgba(59, 130, 246, 0.25);
            border-radius: 8px;
            font-size: 14px;
            transition: all 0.3s ease;
            background: rgba(15, 23, 42, 0.8);
            color: #f1f5f9;
            backdrop-filter: blur(10px);
        }

        .input-group input:focus, .input-group textarea:focus, .input-group select:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 
                0 0 0 3px rgba(59, 130, 246, 0.1),
                0 0 20px rgba(59, 130, 246, 0.15);
            background: rgba(15, 23, 42, 0.95);
        }

        .file-upload {
            position: relative;
            display: inline-block;
            width: 100%;
        }

        .file-upload input[type="file"] {
            display: none;
        }

        .file-upload-btn {
            display: block;
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, #3b82f6, #1d4ed8);
            color: white;
            text-align: center;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
            border: none;
            box-shadow: 0 4px 15px rgba(59, 130, 246, 0.3);
        }

        .file-upload-btn:hover {
            background: linear-gradient(135deg, #1d4ed8, #1e40af);
            transform: translateY(-2px);
            box-shadow: 0 6px 25px rgba(59, 130, 246, 0.4);
        }

        /* Â¢ûÂº∫ÁâàÊñá‰ª∂‰∏ä‰º†Ê†∑Âºè */
        .file-upload-enhanced {
            width: 100%;
        }

        .file-upload-area {
            border: 2px dashed rgba(59, 130, 246, 0.5);
            border-radius: 12px;
            padding: 30px 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            background: rgba(15, 23, 42, 0.6);
            backdrop-filter: blur(10px);
            position: relative;
            overflow: hidden;
        }

        .file-upload-area::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: conic-gradient(
                from 0deg,
                transparent,
                rgba(59, 130, 246, 0.1),
                transparent
            );
            animation: rotate 3s linear infinite;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .file-upload-area:hover::before {
            opacity: 1;
        }

        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        .file-upload-area:hover {
            border-color: #3b82f6;
            background: rgba(59, 130, 246, 0.05);
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(59, 130, 246, 0.2);
        }

        .file-upload-icon {
            font-size: 24px;
            margin-bottom: 15px;
            opacity: 0.7;
            font-weight: 700;
            color: #3b82f6;
            letter-spacing: 2px;
            text-shadow: 0 0 10px rgba(59, 130, 246, 0.5);
        }

        .file-upload-text {
            margin-bottom: 20px;
            position: relative;
            z-index: 1;
        }

        .primary-text {
            font-size: 18px;
            font-weight: 500;
            color: #f1f5f9;
            margin-bottom: 8px;
        }

        .secondary-text {
            font-size: 14px;
            color: #cbd5e1;
            margin-bottom: 5px;
        }

        .file-size-hint {
            font-size: 12px;
            color: #94a3b8;
        }

        .file-upload-area .file-upload-btn {
            display: inline-block;
            width: auto;
            padding: 12px 24px;
            margin: 0;
            border-radius: 6px;
            font-size: 14px;
            position: relative;
            z-index: 1;
        }

        /* Êñá‰ª∂È¢ÑËßàÊ†∑Âºè */
        .file-preview {
            margin-top: 15px;
            border: 2px dashed rgba(59, 130, 246, 0.5);
            border-radius: 12px;
            background: rgba(15, 23, 42, 0.8);
            backdrop-filter: blur(15px);
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
            height: 200px; /* ÂåπÈÖç‰∏ä‰º†Âå∫ÂüüÁöÑÈ´òÂ∫¶ */
            display: flex;
            flex-direction: column;
        }

        .preview-header {
            background: linear-gradient(90deg, 
                rgba(59, 130, 246, 0.1), 
                rgba(147, 51, 234, 0.05)
            );
            padding: 8px 12px;
            border-bottom: 1px solid rgba(59, 130, 246, 0.2);
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-shrink: 0; /* Èò≤Ê≠¢Êî∂Áº© */
            height: 36px; /* Âõ∫ÂÆöÂ§¥ÈÉ®È´òÂ∫¶ÔºåÂáèÂ∞è‰ª•ÂåπÈÖçÊÄªÈ´òÂ∫¶ */
        }

        .preview-title {
            font-weight: 500;
            color: #f1f5f9;
            font-size: 0.9em;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .remove-file-btn {
            background: linear-gradient(135deg, #ef4444, #dc2626);
            color: white;
            border: none;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            transition: all 0.3s ease;
            box-shadow: 0 2px 8px rgba(239, 68, 68, 0.3);
        }

        .remove-file-btn:hover {
            background: linear-gradient(135deg, #dc2626, #b91c1c);
            transform: scale(1.1);
            box-shadow: 0 4px 15px rgba(239, 68, 68, 0.4);
        }

        .preview-content {
            background: rgba(15, 23, 42, 0.8);
            border-radius: 12px;
            padding: 20px;
            border: 1px solid rgba(59, 130, 246, 0.2);
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #cbd5e1;
            font-size: 1.1em;
            backdrop-filter: blur(15px);
            position: relative;
            overflow: hidden;
            overflow-y: auto;
        }

        .preview-content::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(circle at 30% 30%, rgba(59, 130, 246, 0.05) 0%, transparent 50%),
                radial-gradient(circle at 70% 70%, rgba(147, 51, 234, 0.05) 0%, transparent 50%);
            pointer-events: none;
        }

        .preview-content.has-content {
            align-items: flex-start;
            justify-content: flex-start;
            color: #f1f5f9;
        }

        /* ÂõæÁâáÈ¢ÑËßàÊ†∑Âºè - Âõ∫ÂÆöÂ§ßÂ∞èÂíåÊØî‰æãÁº©Êîæ */
        .preview-image {
            width: 100px;
            height: 80px;
            object-fit: contain;
            object-position: center;
            border-radius: 6px;
            background: rgba(30, 41, 59, 0.5);
            border: 1px solid rgba(59, 130, 246, 0.2);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
            flex-shrink: 0; /* Èò≤Ê≠¢ÂõæÁâáË¢´ÂéãÁº© */
        }

        /* Ë∞ÉÊï¥ÂõæÁâáÈ¢ÑËßàÊó∂ÁöÑpreview-content */
        .preview-content.image-preview {
            padding: 30px 20px; /* ‰∏éfile-upload-area‰øùÊåÅ‰∏ÄËá¥ */
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            flex: 1; /* Âç†Áî®Ââ©‰ΩôÁ©∫Èó¥ */
            gap: 10px;
        }

        /* Êñá‰ª∂‰ø°ÊÅØÊ†∑ÂºèË∞ÉÊï¥ */
        .file-info {
            flex: 1;
            margin-left: 12px;
            padding: 8px;
            background: rgba(59, 130, 246, 0.05);
            border-radius: 6px;
            border: 1px solid rgba(59, 130, 246, 0.1);
            min-width: 0; /* ÂÖÅËÆ∏ÂÜÖÂÆπÊî∂Áº© */
        }

        .file-name {
            font-weight: 600;
            color: #f8fafc;
            margin-bottom: 4px;
            word-break: break-word;
            font-size: 0.8em;
            line-height: 1.2;
        }

        .file-size, .file-type {
            font-size: 0.7em;
            color: #cbd5e1;
            margin-bottom: 2px;
            line-height: 1.1;
        }

        /* ÂõæÁâáÂíåÊñá‰ª∂‰ø°ÊÅØÁöÑÂÆπÂô® */
        .image-info-container {
            display: flex;
            align-items: flex-start;
            width: 100%;
            gap: 0;
        }

        .result-content {
            width: 100%;
            position: relative;
            z-index: 1;
        }

        .result-item {
            margin-bottom: 15px;
            padding: 20px;
            background: linear-gradient(135deg, 
                rgba(59, 130, 246, 0.05), 
                rgba(147, 51, 234, 0.02)
            );
            border-radius: 12px;
            border-left: 4px solid #3b82f6;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(59, 130, 246, 0.2);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        .result-item h4 {
            margin-bottom: 12px;
            color: #f1f5f9;
            font-size: 1.1em;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .result-item p {
            margin: 8px 0;
            color: #cbd5e1;
            line-height: 1.5;
        }

        .result-item .success {
            color: #10b981;
            font-weight: 600;
            text-shadow: 0 0 10px rgba(16, 185, 129, 0.3);
        }

        .result-item .error {
            color: #ef4444;
            font-weight: 600;
            text-shadow: 0 0 10px rgba(239, 68, 68, 0.3);
        }

        .loading {
            display: none;
            text-align: center;
            color: #3b82f6;
        }

        .loading.show {
            display: block;
        }

        .spinner {
            border: 3px solid rgba(59, 130, 246, 0.2);
            border-top: 3px solid #3b82f6;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 15px;
            box-shadow: 0 0 20px rgba(59, 130, 246, 0.3);
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .status-message {
            margin-top: 15px;
            padding: 15px;
            border-radius: 8px;
            display: none;
            font-weight: 500;
            backdrop-filter: blur(10px);
            border: 1px solid;
        }

        .status-message.success {
            background: rgba(16, 185, 129, 0.1);
            color: #10b981;
            border-color: rgba(16, 185, 129, 0.3);
            box-shadow: 0 0 20px rgba(16, 185, 129, 0.1);
        }

        .status-message.error {
            background: rgba(239, 68, 68, 0.1);
            color: #ef4444;
            border-color: rgba(239, 68, 68, 0.3);
            box-shadow: 0 0 20px rgba(239, 68, 68, 0.1);
        }

        .status-message.warning {
            background: rgba(245, 158, 11, 0.1);
            color: #f59e0b;
            border-color: rgba(245, 158, 11, 0.3);
            box-shadow: 0 0 20px rgba(245, 158, 11, 0.1);
        }

        .log-container {
            margin-top: 20px;
            max-height: 200px;
            overflow-y: auto;
            background: rgba(30, 41, 59, 0.8);
            border: 1px solid rgba(59, 130, 246, 0.2);
            border-radius: 12px;
            padding: 15px;
            font-family: 'JetBrains Mono', 'Fira Code', 'Courier New', monospace;
            font-size: 12px;
            display: none;
            backdrop-filter: blur(15px);
            box-shadow: inset 0 2px 10px rgba(0, 0, 0, 0.3);
        }

        .log-container.show {
            display: block;
        }

        .log-entry {
            margin-bottom: 6px;
            padding: 4px 0;
            border-left: 2px solid transparent;
            padding-left: 8px;
            transition: all 0.2s ease;
        }

        .log-entry:hover {
            background: rgba(59, 130, 246, 0.05);
            border-left-color: #3b82f6;
        }

        .log-entry.info { 
            color: #3b82f6; 
            border-left-color: rgba(59, 130, 246, 0.3);
        }
        .log-entry.success { 
            color: #10b981; 
            border-left-color: rgba(16, 185, 129, 0.3);
        }
        .log-entry.warning { 
            color: #f59e0b; 
            border-left-color: rgba(245, 158, 11, 0.3);
        }
        .log-entry.error { 
            color: #ef4444; 
            border-left-color: rgba(239, 68, 68, 0.3);
        }
        .log-entry.debug { 
            color: #8b5cf6; 
            border-left-color: rgba(139, 92, 246, 0.3);
        }

        .hidden {
            display: none !important;
        }

        .backend-status {
            margin-bottom: 20px;
            padding: 15px;
            border-radius: 12px;
            background: rgba(15, 23, 42, 0.6);
            border: 1px solid rgba(59, 130, 246, 0.2);
            backdrop-filter: blur(10px);
            position: relative;
            overflow: hidden;
        }

        .backend-status::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 2px;
            background: linear-gradient(90deg, 
                #64748b, 
                #3b82f6, 
                #64748b
            );
        }

        .backend-status.connected::before {
            background: linear-gradient(90deg, 
                #10b981, 
                #34d399, 
                #10b981
            );
        }

        .backend-status.error::before {
            background: linear-gradient(90deg, 
                #ef4444, 
                #f87171, 
                #ef4444
            );
        }

        .status-indicator {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .status-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background-color: #64748b;
            animation: pulse-dot 2s ease-in-out infinite;
            flex-shrink: 0;
        }

        @keyframes pulse-dot {
            0%, 100% { 
                opacity: 1; 
                transform: scale(1);
            }
            50% { 
                opacity: 0.7; 
                transform: scale(1.1);
            }
        }

        .status-text {
            color: #f8fafc;
            font-weight: 500;
            font-size: 0.9em;
        }

        .backend-status p {
            color: #cbd5e1;
            margin: 5px 0 0 22px;
            font-size: 0.8em;
            opacity: 0.8;
        }

        /* ÊªöÂä®Êù°Ê†∑Âºè */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: rgba(15, 23, 42, 0.5);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb {
            background: linear-gradient(180deg, #3b82f6, #1d4ed8);
            border-radius: 4px;
            box-shadow: 0 0 10px rgba(59, 130, 246, 0.3);
        }

        ::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(180deg, #1d4ed8, #1e40af);
        }

        /* ÂìçÂ∫îÂºèËÆæËÆ° - Â§öÊñ≠ÁÇπÈÄÇÈÖç */
        
        /* Ë∂ÖÂ§ßÂ±èÂπï (1920px+) */
        @media (min-width: 1920px) {
            .container {
                max-width: 1800px;
                padding: 0 40px;
            }
            
            .left-panel {
                flex: 0 0 500px;
                padding: 40px;
            }
            
            .header h1 {
                font-size: 2.8em;
            }
            
            .radio-item {
                padding: 22px;
            }
            
            .process-btn {
                padding: 28px 38px;
                font-size: 22px;
            }
        }
        
        /* Â§ßÂ±èÂπï (1440px - 1919px) */
        @media (min-width: 1440px) and (max-width: 1919px) {
            .container {
                max-width: 1600px;
                padding: 0 30px;
            }
            
            .left-panel {
                flex: 0 0 480px;
                padding: 35px;
            }
            
            .header h1 {
                font-size: 2.6em;
            }
            
            .process-btn {
                padding: 26px 34px;
                font-size: 21px;
            }
        }
        
        /* ‰∏≠Á≠âÂ±èÂπï (1024px - 1439px) */
        @media (min-width: 1024px) and (max-width: 1439px) {
            .container {
                max-width: 1200px;
                padding: 0 20px;
            }
            
            .left-panel {
                flex: 0 0 420px;
                padding: 25px;
            }
            
            .header h1 {
                font-size: 2.2em;
            }
            
            .process-btn {
                padding: 22px 28px;
                font-size: 18px;
            }
        }
        
        /* Âπ≥ÊùøÊ®™Â±è (768px - 1023px) */
        @media (min-width: 768px) and (max-width: 1023px) {
            .container {
                flex-direction: row;
                max-width: 100%;
                padding: 0 15px;
            }
            
            .left-panel {
                flex: 0 0 350px;
                padding: 20px;
            }
            
            .right-panel {
                padding: 20px;
            }
            
            .header h1 {
                font-size: 1.8em;
            }
            
            .radio-item {
                padding: 16px;
            }
            
            .process-btn {
                padding: 20px 24px;
                font-size: 16px;
            }
            
            .result-preview-content {
                min-height: 300px;
            }
        }
        
        /* Âπ≥ÊùøÁ´ñÂ±èÂíåÂ∞èÂ±èÂπï (480px - 767px) */
        @media (min-width: 480px) and (max-width: 767px) {
            .container {
                flex-direction: column;
                border-radius: 0;
                padding: 0;
            }

            .left-panel {
                flex: none;
                border-right: none;
                border-bottom: 1px solid rgba(59, 130, 246, 0.3);
                padding: 20px;
            }

            .right-panel {
                padding: 15px;
            }

            .result-preview-section {
                margin-bottom: 15px;
                padding: 15px;
                min-height: 250px;
            }

            .result-details-section {
                padding: 15px;
            }

            .result-preview-content {
                min-height: 200px;
                padding: 15px;
            }

            .result-details-content {
                max-height: 200px;
            }

            .header h1 {
                font-size: 1.6em;
            }

            .file-upload-area {
                padding: 18px 15px;
            }

            .radio-item {
                padding: 14px;
            }

            .process-btn {
                padding: 18px 20px;
                font-size: 16px;
            }
        }
        
        /* ÊâãÊú∫ (max-width: 479px) */
        @media (max-width: 479px) {
            .container {
                flex-direction: column;
                border-radius: 0;
                padding: 0;
            }

            .left-panel {
                flex: none;
                border-right: none;
                border-bottom: 1px solid rgba(59, 130, 246, 0.3);
                padding: 15px;
            }

            .right-panel {
                padding: 10px;
            }

            .result-preview-section {
                margin-bottom: 10px;
                padding: 10px;
                min-height: 200px;
            }

            .result-details-section {
                padding: 10px;
            }

            .result-preview-content {
                min-height: 180px;
                padding: 10px;
            }

            .result-details-content {
                max-height: 150px;
            }

            .preview-image-container {
                flex-direction: column !important;
                gap: 8px;
                padding: 5px;
            }

            .preview-image-container.horizontal,
            .preview-image-container.vertical {
                flex-direction: column !important;
            }

            .preview-image-item {
                max-width: 100%;
                min-width: auto;
            }

            .preview-image-container.horizontal .preview-image,
            .preview-image-container.vertical .preview-image {
                max-width: calc(100% - 10px);
                max-height: calc(35% - 25px);
                width: auto;
                height: auto;
            }

            .download-buttons {
                flex-direction: column;
                gap: 8px;
            }

            .header h1 {
                font-size: 1.4em;
            }

            .file-upload-area {
                padding: 15px 10px;
            }

            .radio-item {
                padding: 12px;
            }

            .process-btn {
                padding: 16px 18px;
                font-size: 14px;
            }

            .placeholder-icon {
                font-size: 32px;
            }

            .placeholder-text h3 {
                font-size: 1em;
            }

            .preview-code-container {
                font-size: 10px;
                padding: 8px;
            }
            
            /* ‰ºòÂåñÂ∞èÂ±èÂπï‰∏äÁöÑËæìÂÖ•Âå∫Âüü */
            .input-group input, 
            .input-group textarea, 
            .input-group select {
                padding: 12px 14px;
                font-size: 16px; /* Èò≤Ê≠¢iOSÁº©Êîæ */
            }
        }

        /* Ëß¶Êë∏ËÆæÂ§á‰ºòÂåñ */
        .touch-device .radio-item {
            min-height: 48px; /* Á¨¶ÂêàËß¶Êë∏Ê†áÂáÜ */
        }
        
        .touch-device .process-btn {
            min-height: 48px;
        }
        
        .touch-device button {
            min-height: 44px;
            min-width: 44px;
        }
        
        .touch-device .file-upload-btn {
            min-height: 48px;
        }
        
        /* È´òÂàÜËæ®ÁéáÂ±èÂπï‰ºòÂåñ */
        .retina {
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
        
        .retina .radio-item {
            border-width: 0.5px;
        }
        
        /* Ê∑ªÂä†ÁÑ¶ÁÇπÊ†∑Âºè */
        button:focus, input:focus, select:focus {
            outline: 2px solid rgba(59, 130, 246, 0.5);
            outline-offset: 2px;
        }

        /* ÈÄâÊã©Ê°ÜÊ†∑Âºè */
        select {
            appearance: none;
            background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%233b82f6' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='m6 8 4 4 4-4'/%3e%3c/svg%3e");
            background-position: right 12px center;
            background-repeat: no-repeat;
            background-size: 16px;
            padding-right: 40px;
        }

        /* Ê∑ªÂä†ÂæÆÂ¶ôÁöÑÂä®ÁîªÊïàÊûú */
        .radio-item, .input-group input, .input-group select, .process-btn, .download-btn {
            animation: fadeInUp 0.5s ease-out;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .process-btn {
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
            border: none;
            padding: 24px 32px;
            border-radius: 16px;
            font-size: 20px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            text-transform: uppercase;
            letter-spacing: 1px;
            width: 100%;
            margin-top: 0px;
            overflow: hidden;
            box-shadow: 
                0 8px 25px rgba(16, 185, 129, 0.4),
                0 0 0 1px rgba(16, 185, 129, 0.2);
            text-align: center;
        }

        .process-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, 
                transparent, 
                rgba(255, 255, 255, 0.2), 
                transparent
            );
            transition: left 0.5s ease;
        }

        .process-btn:hover::before {
            left: 100%;
        }

        .process-btn:hover {
            background: linear-gradient(135deg, #059669, #047857);
            transform: translateY(-3px);
            box-shadow: 
                0 12px 35px rgba(16, 185, 129, 0.5),
                0 0 0 1px rgba(16, 185, 129, 0.3);
        }

        .process-btn:disabled {
            background: linear-gradient(135deg, #374151, #1f2937);
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
            opacity: 0.5;
        }

        .input-content {
            transition: all 0.2s ease-in-out;
        }

        .input-content.hidden {
            opacity: 0;
            transform: translateY(-10px);
        }

        .result-preview-section {
            flex: 2;
            margin-bottom: 20px;
            display: flex;
            flex-direction: column;
            background: rgba(15, 23, 42, 0.4);
            border-radius: 12px;
            padding: 20px;
            border: 1px solid rgba(59, 130, 246, 0.15);
            backdrop-filter: blur(10px);
        }

        .result-details-section {
            flex: 1;
            display: flex;
            flex-direction: column;
            background: rgba(15, 23, 42, 0.4);
            border-radius: 12px;
            padding: 20px;
            border: 1px solid rgba(59, 130, 246, 0.15);
            backdrop-filter: blur(10px);
        }

        .preview-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding: 8px 0;
            border-left: 3px solid #3b82f6;
            padding-left: 12px;
            background: linear-gradient(90deg, #3b82f6, transparent);
        }

        .preview-header h2 {
            color: #f8fafc;
            font-size: 1.5em;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin: 0;
        }

        .details-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding: 6px 0;
            border-left: 2px solid rgba(59, 130, 246, 0.8);
            padding-left: 10px;
            background: linear-gradient(90deg, rgba(59, 130, 246, 0.6), transparent);
            border-radius: 0 4px 4px 0;
        }

        .details-header h3 {
            color: #f8fafc;
            font-size: 0.95em;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.8px;
            margin: 0;
        }

        .result-preview-content {
            flex: 1;
            background: rgba(30, 41, 59, 0.6);
            border-radius: 8px;
            padding: 20px;
            border: 1px solid rgba(59, 130, 246, 0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            overflow: hidden;
            min-height: 300px;
        }

        .result-details-content {
            flex: 1;
            overflow-y: auto;
            max-height: 250px;
        }

        .preview-placeholder {
            text-align: center;
            color: #cbd5e1;
        }

        .placeholder-icon {
            font-size: 48px;
            margin-bottom: 15px;
            opacity: 0.6;
        }

        .placeholder-text h3 {
            color: #f1f5f9;
            margin-bottom: 8px;
            font-size: 1.3em;
            font-weight: 500;
        }

        .placeholder-text p {
            color: #94a3b8;
            font-size: 0.95em;
        }

        .details-placeholder {
            text-align: center;
            color: #94a3b8;
            padding: 40px 20px;
            font-style: italic;
        }

        /* È¢ÑËßàÂÜÖÂÆπÊ†∑Âºè */
        .preview-iframe {
            width: 100%;
            height: 100%;
            border: none;
            border-radius: 6px;
            background: white;
            min-height: 400px;
            z-index: 2;
            position: relative;
        }

        /* PDFÂÆπÂô®ÁâπÊÆäÊ†∑Âºè */
        .preview-pdf-container {
            position: relative;
            overflow: hidden;
        }

        .preview-pdf-container .pdf-fallback {
            pointer-events: none;
            user-select: none;
        }

        .preview-pdf-container iframe {
            display: block;
        }

        .preview-image-container {
            display: flex;
            justify-content: center;
            align-items: center;
            width: 100%;
            height: 100%;
            gap: 15px;
            padding: 10px;
        }

        .preview-image-container.horizontal {
            flex-direction: row;
        }

        .preview-image-container.vertical {
            flex-direction: column;
        }

        .preview-image-item {
            flex: 1;
            text-align: center;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-width: 0; /* ÂÖÅËÆ∏Êî∂Áº© */
        }

        .preview-image-item h4 {
            color: #f1f5f9;
            margin-bottom: 8px;
            font-size: 0.85em;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            white-space: nowrap;
            flex-shrink: 0;
        }

        .preview-image {
            border-radius: 8px;
            border: 1px solid rgba(59, 130, 246, 0.3);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            object-fit: contain;
            background: rgba(255, 255, 255, 0.1);
        }

        /* Ê∞¥Âπ≥ÊéíÂàóÊó∂ÁöÑÂõæÁâáÊ†∑Âºè */
        .preview-image-container.horizontal .preview-image {
            max-width: 100%;
            max-height: calc(100% - 30px); /* ‰∏∫Ê†áÈ¢òÈ¢ÑÁïôÁ©∫Èó¥ */
            width: auto;
            height: auto;
        }

        /* ÂûÇÁõ¥ÊéíÂàóÊó∂ÁöÑÂõæÁâáÊ†∑Âºè */
        .preview-image-container.vertical .preview-image {
            max-width: calc(100% - 20px);
            max-height: calc(50% - 40px); /* ‰∏∫Ê†áÈ¢òÂíåÈó¥Ë∑ùÈ¢ÑÁïôÁ©∫Èó¥ */
            width: auto;
            height: auto;
        }

        .preview-code-container {
            width: 100%;
            height: 100%;
            overflow: auto;
            background: rgba(15, 23, 42, 0.8);
            border-radius: 6px;
            padding: 15px;
            font-family: 'JetBrains Mono', 'Fira Code', 'Courier New', monospace;
            font-size: 12px;
            line-height: 1.5;
            color: #e2e8f0;
        }

        .preview-pdf-container {
            width: 100%;
            height: 100%;
            background: #f8fafc;
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #334155;
            font-size: 1.1em;
        }

        .download-section {
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid rgba(59, 130, 246, 0.2);
        }

        .download-buttons {
            display: flex;
            gap: 10px;
            justify-content: center;
        }

        .download-btn {
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
            border: none;
            padding: 24px 32px;
            border-radius: 16px;
            font-size: 20px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            display: none;
            text-transform: uppercase;
            letter-spacing: 1px;
            box-shadow: 
                0 8px 25px rgba(16, 185, 129, 0.4),
                0 0 0 1px rgba(16, 185, 129, 0.2);
            min-width: 300px;
            overflow: hidden;
            position: relative;
        }

        .download-btn:hover {
            background: linear-gradient(135deg, #059669, #047857);
            transform: translateY(-3px);
            box-shadow: 
                0 12px 35px rgba(16, 185, 129, 0.5),
                0 0 0 1px rgba(16, 185, 129, 0.3);
        }

        .download-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, 
                transparent, 
                rgba(255, 255, 255, 0.2), 
                transparent
            );
            transition: left 0.5s ease;
        }

        .download-btn:hover::before {
            left: 100%;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Â∑¶‰æßÈù¢Êùø -->
        <div class="left-panel">
            <div class="header">
                <h1>ÁßªÊ∞ëÊùêÊñôÁøªËØë<span class="version-badge">V1.41</span></h1>
              
            </div>

            <!-- ÂêéÁ´ØËøûÊé•Áä∂ÊÄÅ -->
            <div id="backend-status" class="backend-status">
                <div class="status-indicator">
                    <span class="status-dot" id="status-dot"></span>
                    <span class="status-text" id="status-text">ÂêéÁ´ØÁä∂ÊÄÅÊ£ÄÊü•‰∏≠...</span>
                </div>
            </div>

            <!-- ÁøªËØëÁ±ªÂûãÈÄâÊã© -->
            <div class="translation-options">
                <div class="option-group">
                    <div class="option-label">ÈÄâÊã©ÁøªËØëÁ±ªÂûã</div>
                    <div class="radio-group">

                        <div class="radio-item active" data-type="webpage-google">
                            <input type="radio" id="webpage-google" name="translationType" value="webpage-google" checked>
                            <label for="webpage-google">
                                ÁΩëÈ°µÁøªËØë
                                <div class="description">ËæìÂÖ•ÁΩëÈ°µÈìæÊé•Âç≥ÂèØËé∑ÂæóÁøªËØëÁâàÁΩëÈ°µ</div>
                            </label>
                        </div>
                        <!-- <div class="radio-item" data-type="webpage-gpt">
                            <input type="radio" id="webpage-gpt" name="translationType" value="webpage-gpt">
                            <label for="webpage-gpt">
                                ÁΩëÈ°µÁøªËØë (ÊµãËØïÁâà)
                                <div class="description">Â¶ÇÊûúÁ®≥ÂÆöÁâàÊó†Ê≥ïÊ≠£Á°ÆÁøªËØëÁΩëÈ°µÔºåËØ∑‰ΩøÁî®ÊµãËØïÁâà</div>
                            </label>
                        </div> -->
                        <div class="radio-item" data-type="poster">
                            <input type="radio" id="poster" name="translationType" value="poster">
                            <label for="poster">
                                Êµ∑Êä•ÁøªËØë
                                <div class="description">Â∞ÜÊµ∑Êä•ÂÜÖÂÆπËΩ¨Êç¢‰∏∫ÂØπÂ∫îÁöÑÁªìÊûÑÂåñË°®Ê†º</div>
                            </label>
                        </div>
                        <div class="radio-item" data-type="baidu-image">
                            <input type="radio" id="baidu-image" name="translationType" value="baidu-image">
                            <label for="baidu-image">
                                ÂõæÁâáÁøªËØë
                                <div class="description">‰∏ä‰º†ÂõæÁâá‰ª•ËøõË°åÁøªËØëÔºåËØ∑Â∞ΩÈáè‰øùËØÅÊñáÂ≠óÊ∏ÖÊô∞</div>
                            </label>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ËæìÂÖ•Âå∫Âüü -->
            <div class="input-section">
                <!-- Êµ∑Êä•ÁøªËØëËæìÂÖ• -->
                <div id="poster-input" class="input-content hidden">
                    <div class="input-group">
                        <label class="sub-label">ÈÄâÊã©Êµ∑Êä•Êñá‰ª∂</label>
                        <div class="file-upload-enhanced">
                            <input type="file" id="poster-file" accept=".png,.jpg,.jpeg,.bmp,.gif,.tiff" style="display: none;">
                            <div class="file-upload-area" onclick="document.getElementById('poster-file').click();">
                                <div class="file-upload-icon">FILE</div>
                                <div class="file-upload-text">
                                    <div class="primary-text">ÁÇπÂáªÈÄâÊã©Êµ∑Êä•Êñá‰ª∂</div>
                                    <div class="secondary-text">ÊîØÊåÅ PNG, JPG, JPEG, BMP, GIF, TIFF Ê†ºÂºè</div>
                                    <div class="file-size-hint">Âª∫ËÆÆÊñá‰ª∂Â§ßÂ∞èÂ∞è‰∫é10MB</div>
                                </div>
                                <div class="file-upload-btn">ÈÄâÊã©Êñá‰ª∂</div>
                            </div>
                            <div id="poster-file-preview" class="file-preview hidden">
                                <div class="preview-header">
                                    <span class="preview-title">Â∑≤ÈÄâÊã©Êñá‰ª∂</span>
                                    <button type="button" class="remove-file-btn" onclick="removePosterFile()">‚úï</button>
                                </div>
                                <div class="preview-content">
                                    <div class="image-info-container">
                                        <img id="poster-preview-img" class="preview-image" alt="Êµ∑Êä•È¢ÑËßà">
                                        <div class="file-info">
                                            <div id="poster-file-name" class="file-name"></div>
                                            <div id="poster-file-size" class="file-size"></div>
                                            <div id="poster-file-type" class="file-type"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- GoogleÁΩëÈ°µÁøªËØëËæìÂÖ• -->
                <div id="webpage-google-input" class="input-content">
                    <div class="input-group">
                        <label for="webpage-google-url" class="sub-label">ËæìÂÖ•ÁΩëÈ°µÈìæÊé•</label>
                        <input type="url" id="webpage-google-url" placeholder="ËØ∑ËæìÂÖ•Ë¶ÅÁøªËØëÁöÑÁΩëÈ°µÈìæÊé•">
                    </div>
                </div>

                <!-- GPTÁΩëÈ°µÁøªËØëËæìÂÖ• -->
                <div id="webpage-gpt-input" class="input-content hidden">
                    <div class="input-group">
                        <label for="webpage-gpt-url" class="sub-label">ËæìÂÖ•ÁΩëÈ°µÈìæÊé•</label>
                        <input type="url" id="webpage-gpt-url" placeholder="ËØ∑ËæìÂÖ•Ë¶ÅÁøªËØëÁöÑÁΩëÈ°µÈìæÊé•">
                    </div>
                </div>

                <!-- BaiduÂõæÁâáÁøªËØëËæìÂÖ• -->
                <div id="baidu-image-input" class="input-content hidden">
                    <div style="display: flex; gap: 15px;">
                        <div class="input-group" style="flex: 1;">
                            <label for="baidu-from-lang">Ê∫êËØ≠Ë®Ä</label>
                            <select id="baidu-from-lang">
                                <option value="zh">‰∏≠Êñá (Chinese)</option>
                                <option value="en">Ëã±ËØ≠ (English)</option>
                                <option value="jp">Êó•ËØ≠ (Japanese)</option>
                                <option value="ko">Èü©ËØ≠ (Korean)</option>
                                <option value="es">Ë•øÁè≠ÁâôËØ≠ (Spanish)</option>
                                <option value="fr">Ê≥ïËØ≠ (French)</option>
                                <option value="th">Ê≥∞ËØ≠ (Thai)</option>
                                <option value="ar">ÈòøÊãâ‰ºØËØ≠ (Arabic)</option>
                                <option value="ru">‰øÑËØ≠ (Russian)</option>
                                <option value="pt">Ëë°ËêÑÁâôËØ≠ (Portuguese)</option>
                                <option value="de">Âæ∑ËØ≠ (German)</option>
                                <option value="it">ÊÑèÂ§ßÂà©ËØ≠ (Italian)</option>
                                <option value="vi">Ë∂äÂçóËØ≠ (Vietnamese)</option>
                                <option value="hi">Âç∞Âú∞ËØ≠ (Hindi)</option>
                            </select>
                        </div>
                        <div class="input-group" style="flex: 1;">
                            <label for="baidu-to-lang">ÁõÆÊ†áËØ≠Ë®Ä</label>
                            <select id="baidu-to-lang">
                                <option value="en">Ëã±ËØ≠ (English)</option>
                                <option value="zh">‰∏≠Êñá (Chinese)</option>
                                <option value="jp">Êó•ËØ≠ (Japanese)</option>
                                <option value="ko">Èü©ËØ≠ (Korean)</option>
                                <option value="es">Ë•øÁè≠ÁâôËØ≠ (Spanish)</option>
                                <option value="fr">Ê≥ïËØ≠ (French)</option>
                                <option value="th">Ê≥∞ËØ≠ (Thai)</option>
                                <option value="ar">ÈòøÊãâ‰ºØËØ≠ (Arabic)</option>
                                <option value="ru">‰øÑËØ≠ (Russian)</option>
                                <option value="pt">Ëë°ËêÑÁâôËØ≠ (Portuguese)</option>
                                <option value="de">Âæ∑ËØ≠ (German)</option>
                                <option value="it">ÊÑèÂ§ßÂà©ËØ≠ (Italian)</option>
                                <option value="vi">Ë∂äÂçóËØ≠ (Vietnamese)</option>
                                <option value="hi">Âç∞Âú∞ËØ≠ (Hindi)</option>
                            </select>
                        </div>
                    </div>
                    <div class="input-group">
                        <label class="sub-label">ÈÄâÊã©ÂõæÁâáÊñá‰ª∂</label>
                        <div class="file-upload-enhanced">
                            <input type="file" id="baidu-image-file" accept=".png,.jpg,.jpeg,.bmp,.gif,.tiff" style="display: none;">
                            <div class="file-upload-area" onclick="document.getElementById('baidu-image-file').click();">
                                <div class="file-upload-icon">IMAGE</div>
                                <div class="file-upload-text">
                                    <div class="primary-text">ÁÇπÂáªÈÄâÊã©ÂõæÁâáÊñá‰ª∂</div>
                                    <div class="secondary-text">ÊîØÊåÅ PNG, JPG, JPEG, BMP, GIF, TIFF Ê†ºÂºè</div>
                                    <div class="file-size-hint">Âª∫ËÆÆÊñá‰ª∂Â§ßÂ∞èÂ∞è‰∫é10MB</div>
                                </div>
                                <div class="file-upload-btn">ÈÄâÊã©Êñá‰ª∂</div>
                            </div>
                            <div id="baidu-image-file-preview" class="file-preview hidden">
                                <div class="preview-header">
                                    <span class="preview-title">Â∑≤ÈÄâÊã©Êñá‰ª∂</span>
                                    <button type="button" class="remove-file-btn" onclick="removeBaiduImageFile()">‚úï</button>
                                </div>
                                <div class="preview-content">
                                    <div class="image-info-container">
                                        <img id="baidu-image-preview-img" class="preview-image" alt="ÂõæÁâáÈ¢ÑËßà">
                                        <div class="file-info">
                                            <div id="baidu-image-file-name" class="file-name"></div>
                                            <div id="baidu-image-file-size" class="file-size"></div>
                                            <div id="baidu-image-file-type" class="file-type"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <button class="process-btn" onclick="processTranslation()" id="process-btn">ÂºÄÂßãÁøªËØë</button>
            </div>

            <!-- Áä∂ÊÄÅÊ∂àÊÅØ -->
            <div id="status-message" class="status-message"></div>


        </div>

        <!-- Âè≥‰æßÈù¢Êùø -->
        <div class="right-panel">
            <!-- ‰∏äÊñπÔºöÁªìÊûúÈ¢ÑËßàÂå∫Âüü -->
            <div class="result-preview-section">
                <div class="preview-header">
                    <h2>ÁøªËØëÁªìÊûúÈ¢ÑËßà</h2>
                </div>

                <div id="result-preview" class="result-preview-content">
                    <div class="preview-placeholder">
                        <div class="placeholder-icon">¬∑¬∑¬∑</div>
                        <div class="placeholder-text">
                            <h3>Á≠âÂæÖÁøªËØëÁªìÊûú</h3>
                            <p>ËØ∑ÈÄâÊã©ÁøªËØëÁ±ªÂûãÂπ∂Êèê‰æõÂÜÖÂÆπ‰ª•ÂºÄÂßãÁøªËØë</p>
                        </div>
                    </div>
                    
                        <div class="loading" id="loading">
                            <div class="spinner"></div>
                            <p id="loading-text">ÁøªËØëÂ§ÑÁêÜ‰∏≠...</p>
                        </div>
                </div>
            </div>

            <!-- ‰∏ãÊñπÔºöÁªìÊûú‰ø°ÊÅØÂàóË°® -->
            <div class="result-details-section">
                <div class="details-header">
                    <h3>Â§ÑÁêÜËØ¶ÊÉÖ</h3>
                </div>
                
                <div id="result-details" class="result-details-content">
                    <div class="details-placeholder">
                        <p>ÁøªËØëÂÆåÊàêÂêéÂ∞ÜÂú®Ê≠§ÊòæÁ§∫ËØ¶ÁªÜ‰ø°ÊÅØ</p>
                    </div>
                </div>

                <div class="download-section">
                    <div class="download-buttons">
                        <button class="download-btn" id="download-main-btn" onclick="downloadMain()">‰∏ãËΩΩÁªìÊûú</button>

                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let currentTranslationType = 'webpage-google';
        let translationResult = null;
        // let backendUrl = 'https://file-translation.zacchen.win';
        //ÊµãËØï
        let backendUrl = 'https://filetrans2.0.drziangchen.uk';
        let logUpdateInterval = null;

        // Â±èÂπïÂàÜËæ®ÁéáÊ£ÄÊµãÂíåËá™ÈÄÇÂ∫îÂ∏ÉÂ±Ä
        function detectScreenSize() {
            const width = window.innerWidth;
            const height = window.innerHeight;
            const dpr = window.devicePixelRatio || 1;
            const screenType = getScreenType(width);
            
            return {
                width,
                height,
                dpr,
                screenType,
                isRetina: dpr > 1,
                isLandscape: width > height,
                aspectRatio: (width / height).toFixed(2)
            };
        }
        
        function getScreenType(width) {
            if (width >= 1920) return 'ultra-wide';
            if (width >= 1440) return 'large';
            if (width >= 1024) return 'medium';
            if (width >= 768) return 'tablet-landscape';
            if (width >= 480) return 'tablet-portrait';
            return 'mobile';
        }
        
        function applyAdaptiveLayout() {
            const screenInfo = detectScreenSize();
            const body = document.body;
            
            // ÁßªÈô§ÊâÄÊúâ‰πãÂâçÁöÑÂ±èÂπïÁ±ªÂûãÁ±ª
            body.classList.remove('ultra-wide', 'large', 'medium', 'tablet-landscape', 'tablet-portrait', 'mobile');
            body.classList.remove('retina', 'landscape', 'portrait');
            
            // Ê∑ªÂä†ÂΩìÂâçÂ±èÂπïÁ±ªÂûãÁ±ª
            body.classList.add(screenInfo.screenType);
            
            if (screenInfo.isRetina) {
                body.classList.add('retina');
            }
            
            if (screenInfo.isLandscape) {
                body.classList.add('landscape');
            } else {
                body.classList.add('portrait');
            }
            
            // ËÆæÁΩÆCSSËá™ÂÆö‰πâÂ±ûÊÄß
            document.documentElement.style.setProperty('--screen-width', screenInfo.width + 'px');
            document.documentElement.style.setProperty('--screen-height', screenInfo.height + 'px');
            document.documentElement.style.setProperty('--device-pixel-ratio', screenInfo.dpr);
            document.documentElement.style.setProperty('--aspect-ratio', screenInfo.aspectRatio);
            
            // Âä®ÊÄÅË∞ÉÊï¥Â≠ó‰ΩìÂ§ßÂ∞è
            adjustFontSizes(screenInfo);
            
            // Âä®ÊÄÅË∞ÉÊï¥ÂÆπÂô®Â∏ÉÂ±Ä
            adjustContainerLayout(screenInfo);
            
            console.log('üì± Â±èÂπï‰ø°ÊÅØ:', {
                Â∞∫ÂØ∏: `${screenInfo.width}x${screenInfo.height}`,
                Á±ªÂûã: screenInfo.screenType,
                ÂÉèÁ¥†ÊØî: screenInfo.dpr,
                ÊñπÂêë: screenInfo.isLandscape ? 'Ê®™Â±è' : 'Á´ñÂ±è',
                È´òÂàÜËæ®Áéá: screenInfo.isRetina ? 'ÊòØ' : 'Âê¶'
            });
        }
        
        function adjustFontSizes(screenInfo) {
            const baseSize = calculateBaseFontSize(screenInfo);
            document.documentElement.style.setProperty('--base-font-size', baseSize + 'px');
            
            // Ê†πÊçÆÂ±èÂπïÂ∞∫ÂØ∏Ë∞ÉÊï¥Ê†πÂ≠ó‰ΩìÂ§ßÂ∞è
            if (screenInfo.width <= 479) {
                document.documentElement.style.fontSize = '14px';
            } else if (screenInfo.width <= 767) {
                document.documentElement.style.fontSize = '15px';
            } else if (screenInfo.width <= 1023) {
                document.documentElement.style.fontSize = '16px';
            } else if (screenInfo.width <= 1439) {
                document.documentElement.style.fontSize = '17px';
            } else {
                document.documentElement.style.fontSize = '18px';
            }
        }
        
        function calculateBaseFontSize(screenInfo) {
            const minSize = 14;
            const maxSize = 20;
            const minWidth = 320;
            const maxWidth = 1920;
            
            const ratio = Math.min(Math.max((screenInfo.width - minWidth) / (maxWidth - minWidth), 0), 1);
            return Math.round(minSize + (maxSize - minSize) * ratio);
        }
        
        function adjustContainerLayout(screenInfo) {
            const container = document.querySelector('.container');
            const leftPanel = document.querySelector('.left-panel');
            
            if (!container || !leftPanel) return;
            
            // Ë∂ÖÂ§ßÂ±èÂπï‰ºòÂåñ
            if (screenInfo.screenType === 'ultra-wide') {
                container.style.maxWidth = '1800px';
                if (screenInfo.width >= 2560) {
                    leftPanel.style.flex = '0 0 600px';
                }
            }
            
            // ÁßªÂä®ËÆæÂ§á‰ºòÂåñ
            if (screenInfo.screenType === 'mobile') {
                // ‰ºòÂåñÁßªÂä®Á´ØÊªöÂä®ÊÄßËÉΩ
                container.style.webkitOverflowScrolling = 'touch';
                container.style.overflowY = 'auto';
            }
        }
        
        function optimizeForMobile() {
            const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
            const isTouchDevice = 'ontouchstart' in window || navigator.maxTouchPoints > 0;
            
            if (isMobile || isTouchDevice) {
                document.body.classList.add('touch-device');
                
                // ‰ºòÂåñËß¶Êë∏‰ΩìÈ™å
                const radioItems = document.querySelectorAll('.radio-item');
                radioItems.forEach(item => {
                    item.style.touchAction = 'manipulation';
                });
                
                // Èò≤Ê≠¢iOSÂèåÂáªÁº©Êîæ
                const buttons = document.querySelectorAll('button');
                buttons.forEach(button => {
                    button.style.touchAction = 'manipulation';
                });
            }
        }
        
        // ÁõëÂê¨Â±èÂπïÂ∞∫ÂØ∏ÂèòÂåñ
        function setupResizeListener() {
            let resizeTimeout;
            
            window.addEventListener('resize', function() {
                clearTimeout(resizeTimeout);
                resizeTimeout = setTimeout(() => {
                    applyAdaptiveLayout();
                    
                    // ÈáçÊñ∞‰ºòÂåñÂõæÁâáÂ∏ÉÂ±Ä
                    const imageContainers = document.querySelectorAll('[id^="image-container-"]');
                    imageContainers.forEach(container => {
                        const containerId = container.id;
                        setTimeout(() => optimizeImageLayout(containerId), 100);
                    });
                }, 150);
            });
            
            // ÁõëÂê¨ËÆæÂ§áÊñπÂêëÂèòÂåñ
            window.addEventListener('orientationchange', function() {
                setTimeout(() => {
                    applyAdaptiveLayout();
                }, 300);
            });
        }

        // ÂàùÂßãÂåñ
        document.addEventListener('DOMContentLoaded', function() {
            setupEventListeners();
            checkBackendStatus(); // ÂàùÂßãÊ£ÄÊü•
            
            // ËÆæÁΩÆÂë®ÊúüÊÄßÂêéÁ´ØÁä∂ÊÄÅÊ£ÄÊü•ÔºàÊØè10Áßí‰∏ÄÊ¨°Ôºâ
            setInterval(checkBackendStatus, 10000);
            
            // ÂàùÂßãÂåñËá™ÈÄÇÂ∫îÂ∏ÉÂ±Ä
            applyAdaptiveLayout();
            setupResizeListener();
            optimizeForMobile();
            
            // Á°Æ‰øùÊòæÁ§∫Ê≠£Á°ÆÁöÑÈªòËÆ§ËæìÂÖ•Âå∫Âüü
            updateInputSection();
            updateRadioItemStyles();
            
            // Ê£ÄÊü•PDFÊîØÊåÅ
            const pdfSupported = checkPdfSupport();
            console.log('ÊµèËßàÂô®PDFÊîØÊåÅÁä∂ÊÄÅ:', pdfSupported ? 'ÊîØÊåÅ' : '‰∏çÊîØÊåÅ');
            
            if (!pdfSupported) {
                console.warn('‚ö†Ô∏è ÊÇ®ÁöÑÊµèËßàÂô®ÂèØËÉΩ‰∏çÊîØÊåÅPDFÈ¢ÑËßàÔºåÂª∫ËÆÆ‰ΩøÁî®Chrome„ÄÅFirefoxÊàñEdgeÊµèËßàÂô®');
                addLogEntry('ÊµèËßàÂô®PDFÊîØÊåÅÂèóÈôêÔºåÂª∫ËÆÆ‰ΩøÁî®ChromeÊµèËßàÂô®', 'warning');
            } else {
                addLogEntry('ÊµèËßàÂô®PDFÊîØÊåÅÊ≠£Â∏∏', 'success');
            }
            
            // ÊòæÁ§∫Ë∞ÉËØï‰ø°ÊÅØ
            console.log('üîß Ë∞ÉËØïÂ∑•ÂÖ∑Â∑≤Âä†ËΩΩ:');
            console.log('  - debugPdfFiles() - Êü•ÁúãÂèØÁî®PDFÊñá‰ª∂');
            console.log('  - testPdfPreview(url) - ÊµãËØïPDFÈ¢ÑËßàURL');
            console.log('  - testCurrentPdf() - ÊµãËØïÂΩìÂâçÁøªËØëÁªìÊûúÁöÑPDF');
            console.log('  - testPdfInfrastructure() - ÊµãËØïPDFÈ¢ÑËßàÂü∫Á°ÄËÆæÊñΩ');
            console.log('  - checkPdfSupport() - Ê£ÄÊü•PDFÊîØÊåÅ');
            console.log('  - applyAdaptiveLayout() - ÈáçÊñ∞Â∫îÁî®Ëá™ÈÄÇÂ∫îÂ∏ÉÂ±Ä');
            console.log('  - detectScreenSize() - Ê£ÄÊµãÂΩìÂâçÂ±èÂπï‰ø°ÊÅØ');
            console.log('üí° ÊèêÁ§∫: ÁøªËØëÂÆåÊàêÂêéÂèØ‰ΩøÁî®ÊéßÂà∂Âè∞ÂëΩ‰ª§ËøõË°åË∞ÉËØï');
            console.log('üß™ Â¶ÇÊûúPDFÈ¢ÑËßàÊúâÈóÆÈ¢òÔºåËØ∑ÂÖàËøêË°å testPdfInfrastructure() ËøõË°åÂü∫Á°ÄÊµãËØï');
            
            const screenInfo = detectScreenSize();
            addLogEntry(`ÁßªÊ∞ëÊùêÊñôÁøªËØëÂπ≥Âè∞ÂâçÁ´ØÂ∑≤Âä†ËΩΩ - ÂìçÂ∫îÂºèÁâà v3.0 (${screenInfo.width}x${screenInfo.height})`, 'success');
            addLogEntry(`ÂΩìÂâçÂ±èÂπïÁ±ªÂûã: ${screenInfo.screenType} (${screenInfo.isLandscape ? 'Ê®™Â±è' : 'Á´ñÂ±è'})`, 'info');
            addLogEntry('Ëá™ÈÄÇÂ∫îÂ∏ÉÂ±ÄÂ∑≤ÂêØÁî®ÔºåÊîØÊåÅÂ§öÁßçÂ±èÂπïÂ∞∫ÂØ∏', 'success');
        });

        // Â§ÑÁêÜÊµ∑Êä•Êñá‰ª∂ÈÄâÊã©
        function handlePosterFileSelect(input) {
            const file = input.files[0];
            const preview = document.getElementById('poster-file-preview');
            const uploadArea = document.querySelector('.file-upload-area');
            
            if (file) {
                // È™åËØÅÊñá‰ª∂Â§ßÂ∞è
                const maxSize = 10 * 1024 * 1024; // 10MB
                if (file.size > maxSize) {
                    alert(`Êñá‰ª∂Â§ßÂ∞èË∂ÖËøáÈôêÂà∂Ôºà${(file.size/1024/1024).toFixed(2)}MB > 10MBÔºâ`);
                    input.value = '';
                    return;
                }
                
                // È™åËØÅÊñá‰ª∂Á±ªÂûã
                const allowedTypes = ['image/png', 'image/jpeg', 'image/jpg', 'image/bmp', 'image/gif', 'image/tiff'];
                if (!allowedTypes.includes(file.type)) {
                    alert(`‰∏çÊîØÊåÅÁöÑÊñá‰ª∂Á±ªÂûã: ${file.type}`);
                    input.value = '';
                    return;
                }
                
                // ÊòæÁ§∫È¢ÑËßà
                preview.classList.remove('hidden');
                uploadArea.style.display = 'none';
                
                // Êõ¥Êñ∞Êñá‰ª∂‰ø°ÊÅØ
                document.getElementById('poster-file-name').textContent = file.name;
                document.getElementById('poster-file-size').textContent = `${(file.size/1024).toFixed(2)} KB`;
                document.getElementById('poster-file-type').textContent = file.type;
                
                // ÊòæÁ§∫ÂõæÂÉèÈ¢ÑËßà
                const reader = new FileReader();
                reader.onload = function(e) {
                    document.getElementById('poster-preview-img').src = e.target.result;
                    // ‰∏∫È¢ÑËßàÂÆπÂô®Ê∑ªÂä†ÂõæÁâáÈ¢ÑËßàÊ†∑ÂºèÁ±ª
                    const previewContent = preview.querySelector('.preview-content');
                    if (previewContent) {
                        previewContent.classList.add('image-preview');
                    }
                };
                reader.readAsDataURL(file);
            } else {
                // ÈöêËóèÈ¢ÑËßà
                preview.classList.add('hidden');
                uploadArea.style.display = 'block';
            }
        }

        // ÁßªÈô§Êµ∑Êä•Êñá‰ª∂
        function removePosterFile() {
            const input = document.getElementById('poster-file');
            const preview = document.getElementById('poster-file-preview');
            const uploadArea = document.querySelector('.file-upload-area');
            
            input.value = '';
            preview.classList.add('hidden');
            uploadArea.style.display = 'block';
            
            // ÁßªÈô§ÂõæÁâáÈ¢ÑËßàÊ†∑ÂºèÁ±ª
            const previewContent = preview.querySelector('.preview-content');
            if (previewContent) {
                previewContent.classList.remove('image-preview');
            }
        }

        // Â§ÑÁêÜÁôæÂ∫¶ÂõæÁâáÊñá‰ª∂ÈÄâÊã©
        function handleBaiduImageFileSelect(input) {
            const file = input.files[0];
            const preview = document.getElementById('baidu-image-file-preview');
            const uploadArea = document.querySelector('#baidu-image-input .file-upload-area');
            
            if (file) {
                // È™åËØÅÊñá‰ª∂Â§ßÂ∞è
                const maxSize = 10 * 1024 * 1024; // 10MB
                if (file.size > maxSize) {
                    alert(`Êñá‰ª∂Â§ßÂ∞èË∂ÖËøáÈôêÂà∂Ôºà${(file.size/1024/1024).toFixed(2)}MB > 10MBÔºâ`);
                    input.value = '';
                    return;
                }
                
                // È™åËØÅÊñá‰ª∂Á±ªÂûã
                const allowedTypes = ['image/png', 'image/jpeg', 'image/jpg', 'image/bmp', 'image/gif', 'image/tiff'];
                if (!allowedTypes.includes(file.type)) {
                    alert(`‰∏çÊîØÊåÅÁöÑÊñá‰ª∂Á±ªÂûã: ${file.type}`);
                    input.value = '';
                    return;
                }
                
                // ÊòæÁ§∫È¢ÑËßà
                preview.classList.remove('hidden');
                uploadArea.style.display = 'none';
                
                // Êõ¥Êñ∞Êñá‰ª∂‰ø°ÊÅØ
                document.getElementById('baidu-image-file-name').textContent = file.name;
                document.getElementById('baidu-image-file-size').textContent = `${(file.size/1024).toFixed(2)} KB`;
                document.getElementById('baidu-image-file-type').textContent = file.type;
                
                // ÊòæÁ§∫ÂõæÂÉèÈ¢ÑËßà
                const reader = new FileReader();
                reader.onload = function(e) {
                    document.getElementById('baidu-image-preview-img').src = e.target.result;
                    // ‰∏∫È¢ÑËßàÂÆπÂô®Ê∑ªÂä†ÂõæÁâáÈ¢ÑËßàÊ†∑ÂºèÁ±ª
                    const previewContent = preview.querySelector('.preview-content');
                    if (previewContent) {
                        previewContent.classList.add('image-preview');
                    }
                };
                reader.readAsDataURL(file);
            } else {
                // ÈöêËóèÈ¢ÑËßà
                preview.classList.add('hidden');
                uploadArea.style.display = 'block';
            }
        }

        // ÁßªÈô§ÁôæÂ∫¶ÂõæÁâáÊñá‰ª∂
        function removeBaiduImageFile() {
            const input = document.getElementById('baidu-image-file');
            const preview = document.getElementById('baidu-image-file-preview');
            const uploadArea = document.querySelector('#baidu-image-input .file-upload-area');
            
            input.value = '';
            preview.classList.add('hidden');
            uploadArea.style.display = 'block';
            
            // ÁßªÈô§ÂõæÁâáÈ¢ÑËßàÊ†∑ÂºèÁ±ª
            const previewContent = preview.querySelector('.preview-content');
            if (previewContent) {
                previewContent.classList.remove('image-preview');
            }
        }

        function setupEventListeners() {
            // ÁøªËØëÁ±ªÂûãÈÄâÊã©
            document.querySelectorAll('input[name="translationType"]').forEach(radio => {
                radio.addEventListener('change', function() {
                    currentTranslationType = this.value;
                    updateInputSection();
                    updateRadioItemStyles();
                });
            });

            // Êñá‰ª∂‰∏ä‰º†ÊåâÈíÆ
            document.querySelectorAll('.file-upload input[type="file"]').forEach(input => {
                input.addEventListener('change', function() {
                    updateFileUploadButton(this);
                });
            });

            // Êµ∑Êä•Êñá‰ª∂ÈÄâÊã©
            const posterFileInput = document.getElementById('poster-file');
            if (posterFileInput) {
                posterFileInput.addEventListener('change', function() {
                    handlePosterFileSelect(this);
                });
            }

            // ÁôæÂ∫¶ÂõæÁâáÊñá‰ª∂ÈÄâÊã©
            const baiduImageFileInput = document.getElementById('baidu-image-file');
            if (baiduImageFileInput) {
                baiduImageFileInput.addEventListener('change', function() {
                    handleBaiduImageFileSelect(this);
                });
            }
        }

        async function checkBackendStatus() {
            const statusEl = document.getElementById('backend-status');
            const statusDot = document.getElementById('status-dot');
            const statusText = document.getElementById('status-text');
            
            try {
                const response = await fetch(`${backendUrl}/api/test`);
                if (response.ok) {
                    const data = await response.json();
                    statusEl.className = 'backend-status connected';
                    statusDot.style.backgroundColor = '#10b981';
                    statusText.textContent = 'ÂêéÁ´ØËøûÊé•Ê≠£Â∏∏';
                } else {
                    throw new Error('ËøûÊé•Â§±Ë¥•');
                }
            } catch (error) {
                statusEl.className = 'backend-status error';
                statusDot.style.backgroundColor = '#ef4444';
                statusText.textContent = 'ÂêéÁ´ØËøûÊé•Â§±Ë¥•';
            }
        }

        function updateRadioItemStyles() {
            document.querySelectorAll('.radio-item').forEach(item => {
                item.classList.remove('active');
            });
            document.querySelector(`.radio-item[data-type="${currentTranslationType}"]`).classList.add('active');
        }

        function updateInputSection() {
            // Âø´ÈÄüÈöêËóèÊâÄÊúâËæìÂÖ•Âå∫Âüü
            document.querySelectorAll('.input-content').forEach(content => {
                content.classList.add('hidden');
            });

            // Áü≠ÊöÇÂª∂ËøüÂêéÊòæÁ§∫ÂØπÂ∫îÁöÑËæìÂÖ•Âå∫ÂüüÔºåÂàõÂª∫Âπ≥ÊªëËøáÊ∏°
            setTimeout(() => {
                const targetElement = document.getElementById(`${currentTranslationType}-input`);
                if (targetElement) {
                    targetElement.classList.remove('hidden');
                }
            }, 100);
            
            // ÈáçÁΩÆÈ¢ÑËßàÂå∫Âüü
            resetPreview();
        }

        function updateFileUploadButton(input) {
            const button = input.nextElementSibling;
            if (input.files.length > 0) {
                button.textContent = `üìÅ Â∑≤ÈÄâÊã©: ${input.files[0].name}`;
                button.style.background = '#28a745';
            } else {
                button.textContent = 'üìÅ ÈÄâÊã©Êñá‰ª∂';
                button.style.background = '#667eea';
            }
        }

        function showLoading(text = 'ÁøªËØëÂ§ÑÁêÜ‰∏≠...') {
            document.getElementById('loading-text').textContent = text;
            document.getElementById('loading').classList.add('show');
            document.querySelectorAll('.download-btn').forEach(btn => btn.style.display = 'none');
            document.getElementById('process-btn').disabled = true;
            hideStatusMessage();
            
            // ÈöêËóèÂç†‰ΩçÁ¨¶ÂÜÖÂÆπÔºåÈÅøÂÖç‰∏éÂä†ËΩΩÁä∂ÊÄÅÈáçÂè†
            const placeholders = document.querySelectorAll('.preview-placeholder');
            placeholders.forEach(placeholder => {
                placeholder.style.display = 'none';
            });
        }

        function hideLoading() {
            document.getElementById('loading').classList.remove('show');
            document.getElementById('process-btn').disabled = false;
            
            // Â¶ÇÊûúÊ≤°ÊúâÁøªËØëÁªìÊûúÔºåÈáçÊñ∞ÊòæÁ§∫Âç†‰ΩçÁ¨¶
            if (!translationResult) {
                const placeholders = document.querySelectorAll('.preview-placeholder');
                placeholders.forEach(placeholder => {
                    placeholder.style.display = 'block';
                });
            }
        }

        function showStatusMessage(message, type) {
            const statusEl = document.getElementById('status-message');
            statusEl.textContent = message;
            statusEl.className = `status-message ${type}`;
            statusEl.style.display = 'block';
        }

        function hideStatusMessage() {
            document.getElementById('status-message').style.display = 'none';
        }

        function showLogContainer() {
            const logContainer = document.getElementById('log-container');
            if (logContainer) {
                logContainer.classList.add('show');
            }
        }

        function hideLogContainer() {
            const logContainer = document.getElementById('log-container');
            if (logContainer) {
                logContainer.classList.remove('show');
            }
        }

        function addLogEntry(message, type = 'info') {
            const logContent = document.getElementById('log-content');
            if (!logContent) return; // Â¶ÇÊûúÊó•ÂøóÂÆπÂô®‰∏çÂ≠òÂú®ÔºåÁõ¥Êé•ËøîÂõû
            
            const timestamp = new Date().toLocaleTimeString();
            const logEntry = document.createElement('div');
            logEntry.className = `log-entry ${type}`;
            
            // ÁÆÄÂåñÁöÑÊó•ÂøóÊ†ºÂºèÔºåÁßªÈô§emoji
            const prefix = {
                'info': '[INFO]',
                'success': '[SUCCESS]',
                'warning': '[WARNING]',
                'error': '[ERROR]',
                'debug': '[DEBUG]'
            };
            
            logEntry.textContent = `[${timestamp}] ${prefix[type] || '[INFO]'} ${message}`;
            logContent.appendChild(logEntry);
            
            // Ëá™Âä®ÊªöÂä®Âà∞Â∫ïÈÉ®
            logContent.scrollTop = logContent.scrollHeight;
        }

        function clearLogs() {
            const logContent = document.getElementById('log-content');
            if (logContent) {
                logContent.innerHTML = '';
            }
        }

        function resetPreview() {
            const resultPreview = document.getElementById('result-preview');
            const resultDetails = document.getElementById('result-details');
            
            // ÈáçÁΩÆÈ¢ÑËßàÂå∫Âüü
            resultPreview.innerHTML = `
                <div class="preview-placeholder">
                    <div class="placeholder-icon">¬∑¬∑¬∑</div>
                    <div class="placeholder-text">
                        <h3>Á≠âÂæÖÁøªËØëÁªìÊûú</h3>
                        <p>ËØ∑ÈÄâÊã©ÁøªËØëÁ±ªÂûãÂπ∂Êèê‰æõÂÜÖÂÆπ‰ª•ÂºÄÂßãÁøªËØë</p>
                    </div>
                </div>
                <div class="loading" id="loading">
                    <div class="spinner"></div>
                    <p id="loading-text">ÁøªËØëÂ§ÑÁêÜ‰∏≠...</p>
                </div>
            `;
            
            // ÈáçÁΩÆËØ¶ÊÉÖÂå∫Âüü
            resultDetails.innerHTML = `
                <div class="details-placeholder">
                    <p>ÁøªËØëÂÆåÊàêÂêéÂ∞ÜÂú®Ê≠§ÊòæÁ§∫ËØ¶ÁªÜ‰ø°ÊÅØ</p>
                </div>
            `;
            
            document.querySelectorAll('.download-btn').forEach(btn => btn.style.display = 'none');
            translationResult = null;
            hideLogContainer();
            clearLogs();
        }

        async function processTranslation() {
            try {
                showLoading();
                clearLogs();
                showLogContainer();
                addLogEntry('ÂºÄÂßãÁøªËØëÊµÅÁ®ã', 'info');
                
                let isValid = false;
                let requestData = {};
                let endpoint = '';
                let method = 'POST';
                let isFormData = false;

                // È™åËØÅËæìÂÖ•Âπ∂Êî∂ÈõÜÊï∞ÊçÆ
                switch (currentTranslationType) {
                    case 'poster':
                        addLogEntry('È™åËØÅÊµ∑Êä•ÁøªËØëËæìÂÖ•', 'debug');
                        const posterFile = document.getElementById('poster-file').files[0];
                        
                        if (!posterFile) {
                            throw new Error('ËØ∑ÈÄâÊã©Êµ∑Êä•Êñá‰ª∂');
                        }
                        
                        // È™åËØÅÊñá‰ª∂Â§ßÂ∞èÔºàÈôêÂà∂10MBÔºâ
                        const maxSize = 10 * 1024 * 1024; // 10MB
                        if (posterFile.size > maxSize) {
                            throw new Error(`Êñá‰ª∂Â§ßÂ∞èË∂ÖËøáÈôêÂà∂Ôºà${(posterFile.size/1024/1024).toFixed(2)}MB > 10MBÔºâ`);
                        }
                        
                        // È™åËØÅÊñá‰ª∂Á±ªÂûã
                        const allowedTypes = ['image/png', 'image/jpeg', 'image/jpg', 'image/bmp', 'image/gif', 'image/tiff'];
                        if (!allowedTypes.includes(posterFile.type)) {
                            throw new Error(`‰∏çÊîØÊåÅÁöÑÊñá‰ª∂Á±ªÂûã: ${posterFile.type}`);
                        }

                        addLogEntry(`ÈÄâÊã©ÁöÑÊñá‰ª∂: ${posterFile.name}`, 'info');
                        addLogEntry(`Êñá‰ª∂Â§ßÂ∞è: ${(posterFile.size/1024).toFixed(2)} KB`, 'info');
                        addLogEntry(`Êñá‰ª∂Á±ªÂûã: ${posterFile.type}`, 'info');
                        addLogEntry('‰ΩøÁî®ÂêéÁ´ØÈÖçÁΩÆÁöÑAPIÂØÜÈí•', 'debug');
                        addLogEntry('ÂáÜÂ§áË∞ÉÁî®Êµ∑Êä•ÁøªËØëAPIÔºàÂ¢ûÂº∫ÁâàÔºâ', 'info');

                        const posterFormData = new FormData();
                        posterFormData.append('image', posterFile);
                        
                        requestData = posterFormData;
                        endpoint = '/api/poster-translate';
                        isFormData = true;
                        isValid = true;
                        showLoading('Êµ∑Êä•ÁøªËØë‰∏≠...');
                        break;
                    
                    case 'webpage-gpt':
                        addLogEntry('È™åËØÅGPTÁΩëÈ°µÁøªËØëËæìÂÖ•', 'debug');
                        const gptUrl = document.getElementById('webpage-gpt-url').value.trim();
                        
                        if (!gptUrl) {
                            throw new Error('ËØ∑ËæìÂÖ•ÁΩëÈ°µÈìæÊé•');
                        }

                        addLogEntry(`ÁõÆÊ†áURL: ${gptUrl}`, 'info');
                        addLogEntry('‰ΩøÁî®ÂêéÁ´ØÈÖçÁΩÆÁöÑAPIÂØÜÈí•', 'debug');
                        addLogEntry('ÂáÜÂ§áË∞ÉÁî®GPTÁøªËØëAPIÔºàÂ¢ûÂº∫ÁâàÔºâ', 'info');

                        requestData = {
                            url: gptUrl
                        };
                        
                        endpoint = '/api/webpage-gpt-translate';
                        isValid = true;
                        showLoading('ÁΩëÈ°µÁøªËØë‰∏≠...');
                        break;
                    
                    case 'webpage-google':
                        addLogEntry('È™åËØÅGoogleÁΩëÈ°µÁøªËØëËæìÂÖ•', 'debug');
                        const googleUrl = document.getElementById('webpage-google-url').value.trim();
                        
                        if (!googleUrl) {
                            throw new Error('ËØ∑ËæìÂÖ•ÁΩëÈ°µÈìæÊé•');
                        }

                        addLogEntry(`ÁõÆÊ†áURL: ${googleUrl}`, 'info');
                        addLogEntry('ÂáÜÂ§áË∞ÉÁî®GoogleÁøªËØëAPI', 'info');

                        requestData = {
                            url: googleUrl
                        };
                        
                        endpoint = '/api/webpage-google-translate';
                        isValid = true;
                        showLoading('ÁΩëÈ°µÁøªËØë‰∏≠...');
                        break;

                    case 'baidu-image':
                        addLogEntry('È™åËØÅÁôæÂ∫¶ÂõæÁâáÁøªËØëËæìÂÖ•', 'debug');
                        const baiduFromLang = document.getElementById('baidu-from-lang').value;
                        const baiduToLang = document.getElementById('baidu-to-lang').value;
                        const baiduImageFile = document.getElementById('baidu-image-file').files[0];

                        if (!baiduImageFile) {
                            throw new Error('ËØ∑ÈÄâÊã©ÂõæÁâáÊñá‰ª∂');
                        }

                        // È™åËØÅÊñá‰ª∂Â§ßÂ∞èÔºàÈôêÂà∂10MBÔºâ
                        const maxBaiduSize = 10 * 1024 * 1024; // 10MB
                        if (baiduImageFile.size > maxBaiduSize) {
                            throw new Error(`Êñá‰ª∂Â§ßÂ∞èË∂ÖËøáÈôêÂà∂Ôºà${(baiduImageFile.size/1024/1024).toFixed(2)}MB > 10MBÔºâ`);
                        }

                        // È™åËØÅÊñá‰ª∂Á±ªÂûã
                        const allowedBaiduTypes = ['image/png', 'image/jpeg', 'image/jpg', 'image/bmp', 'image/gif', 'image/tiff'];
                        if (!allowedBaiduTypes.includes(baiduImageFile.type)) {
                            throw new Error(`‰∏çÊîØÊåÅÁöÑÊñá‰ª∂Á±ªÂûã: ${baiduImageFile.type}`);
                        }

                        addLogEntry(`ÈÄâÊã©ÁöÑÊñá‰ª∂: ${baiduImageFile.name}`, 'info');
                        addLogEntry(`Êñá‰ª∂Â§ßÂ∞è: ${(baiduImageFile.size/1024).toFixed(2)} KB`, 'info');
                        addLogEntry(`ÁøªËØëÊñπÂêë: ${baiduFromLang} -> ${baiduToLang}`, 'info');
                        addLogEntry('‰ΩøÁî®ÂêéÁ´ØÈÖçÁΩÆÁöÑAPIÂØÜÈí•', 'debug');
                        addLogEntry('ÂáÜÂ§áË∞ÉÁî®ÁôæÂ∫¶ÂõæÁâáÁøªËØëAPI', 'info');

                        const baiduFormData = new FormData();
                        baiduFormData.append('image', baiduImageFile);
                        baiduFormData.append('from_lang', baiduFromLang);
                        baiduFormData.append('to_lang', baiduToLang);
                        baiduFormData.append('save_image', 'true');
                        
                        requestData = baiduFormData;
                        endpoint = '/api/image-translate';
                        isFormData = true;
                        isValid = true;
                        showLoading('ÂõæÁâáÁøªËØë‰∏≠...');
                        break;
                }

                if (!isValid) {
                    throw new Error('ËØ∑Êèê‰æõÊúâÊïàÁöÑËæìÂÖ•ÂÜÖÂÆπ');
                }

                // Ë∞ÉÁî®ÂêéÁ´ØAPI
                addLogEntry('ÂèëÈÄÅËØ∑Ê±ÇÂà∞ÂêéÁ´ØÊúçÂä°', 'info');
                const response = await callBackendAPI(endpoint, requestData, isFormData);
                
                if (response.success) {
                    addLogEntry('ÂêéÁ´ØÂ§ÑÁêÜÊàêÂäü', 'success');
                    addLogEntry('Ê≠£Âú®ÊòæÁ§∫ÁøªËØëÁªìÊûú', 'info');
                    displayResult(response);
                    showStatusMessage('ÁøªËØëÂÆåÊàêÔºÅ', 'success');
                    addLogEntry('ÁøªËØëÊµÅÁ®ãÂÆåÊàê', 'success');
                } else {
                    addLogEntry(`ÂêéÁ´ØËøîÂõûÈîôËØØ: ${response.error}`, 'error');
                    throw new Error(response.error || 'ÁøªËØëÂ§±Ë¥•');
                }
                
            } catch (error) {
                hideLoading();
                addLogEntry(`Â§ÑÁêÜÂ§±Ë¥•: ${error.message}`, 'error');
                showStatusMessage(error.message, 'error');
                console.error('Translation error:', error);
            }
        }

        async function callBackendAPI(endpoint, data, isFormData = false) {
            const url = `${backendUrl}${endpoint}`;
            
            const options = {
                method: 'POST',
                body: isFormData ? data : JSON.stringify(data)
            };

            if (!isFormData) {
                options.headers = {
                    'Content-Type': 'application/json'
                };
            }

            const response = await fetch(url, options);
            return await response.json();
        }

        // function displayResult(result) {
        //     hideLoading();

        //     // ÁîüÊàêÈ¢ÑËßàÂÜÖÂÆπ
        //     const previewContent = generatePreviewContent(result);
            
        //     // ÁîüÊàêËØ¶ÊÉÖÂÜÖÂÆπ
        //     const detailsContent = generateDetailsContent(result);
            
        //     // Êõ¥Êñ∞È¢ÑËßàÂå∫Âüü
        //     const resultPreview = document.getElementById('result-preview');
        //     resultPreview.innerHTML = previewContent;
            
        //     // Êõ¥Êñ∞ËØ¶ÊÉÖÂå∫Âüü
        //     const resultDetails = document.getElementById('result-details');
        //     resultDetails.innerHTML = detailsContent;

        //     // ‰øùÂ≠òÁªìÊûúÊï∞ÊçÆ
        //     translationResult = result;

        //     // ÊòæÁ§∫Áõ∏Â∫îÁöÑ‰∏ãËΩΩÊåâÈíÆ
        //     showDownloadButtons(result);
            
        //     // Â¶ÇÊûúÊúâPDFÈ¢ÑËßàÔºåÊµãËØïURLÂèØËÆøÈóÆÊÄß
        //     if ((currentTranslationType === 'poster' && result.pdf_generated) ||
        //         (currentTranslationType.startsWith('webpage') && result.download_url)) {
        //         setTimeout(() => testPdfUrls(result), 1000);
        //     }
        // }

        function displayResult(result) {
        hideLoading();
        translationResult = result; // ‰øùÂ≠òÁªìÊûú‰ª•‰æõ‰∏ãËΩΩ

        const resultPreview = document.getElementById('result-preview');
        const resultDetails = document.getElementById('result-details');
        
        let previewContent = '';
        let detailsContent = '';

        try {
            // --- Ê†πÊçÆ‰∏çÂêåÁöÑÁøªËØëÁ±ªÂûãÁîüÊàêÈ¢ÑËßàÂíåËØ¶ÊÉÖ ---
            const filename = result.pdf_filename || result.translated_filename;
            if (!filename) {
                // Â¶ÇÊûúÂêéÁ´ØÊ≤°ÊúâËøîÂõûÊúâÊïàÁöÑÊñá‰ª∂ÂêçÔºåÂàôÊòæÁ§∫ÈîôËØØ
                if (currentTranslationType === 'baidu-image' && result.has_translated_image === false) {
                     // ÂõæÁâáÁøªËØëÂè™ËøîÂõûÊñáÊú¨ÔºåÊòØÊ≠£Â∏∏ÊÉÖÂÜµ
                } else {
                    throw new Error(result.error || 'ÂêéÁ´ØÊú™ËøîÂõûÊúâÊïàÁöÑÊñá‰ª∂Âêç„ÄÇ');
                }
            }
            
            // --- ÂÖ≥ÈîÆ‰øÆÊ≠£ÔºöÂØπÊâÄÊúâÊñá‰ª∂ÂêçËøõË°åURLÁºñÁ†Å ---
            const encodedFilename = encodeURIComponent(filename);
            let previewUrlPath = '';

            if (currentTranslationType === 'poster') {
                previewUrlPath = `/preview/poster/${encodedFilename}`;
            } else if (currentTranslationType === 'webpage-google') {
                previewUrlPath = `/preview/translated/${encodedFilename}`;
            } else if (currentTranslationType === 'webpage-gpt') {
                const folder = result.folder_name;
                previewUrlPath = `/preview/workflow/${folder}/${encodedFilename}`;
            }

            if (previewUrlPath) {
                const fullPreviewUrl = `${backendUrl}${previewUrlPath}`;
                previewContent = `<iframe src="${fullPreviewUrl}" class="preview-iframe" title="ÁøªËØëÁªìÊûúPDFÈ¢ÑËßà"></iframe>`;
            } else if (currentTranslationType === 'baidu-image') {
                // ÂØπ‰∫éÂõæÁâáÁøªËØëÔºåÊàë‰ª¨‰ªçÁÑ∂Êé®Ëçê‰ΩøÁî®Base64Ôºå‰ΩÜÂ¶ÇÊûúÂùöÊåÅURLÊñπÂºèÔºåÈúÄË¶ÅÂêéÁ´ØËøîÂõûÊ≠£Á°ÆÁöÑURL
                // ËøôÈáåÊöÇÊó∂‰øùÊåÅÂéüÊ†∑ÔºåÂõ†‰∏∫ÂõæÁâáÈ¢ÑËßàÈóÆÈ¢òÊõ¥Â§çÊùÇ
                 if (result.has_translated_image && result.download_url) {
                    const originalImageUrl = result.original_image_url ? `${backendUrl}${result.original_image_url}` : '';
                    const translatedImageUrl = result.download_url ? `${backendUrl}${result.download_url}` : '';
                    previewContent = `
                        <div class="preview-image-container horizontal">
                            <div class="preview-image-item"><h4>ÂéüÂßãÂõæÁâá</h4><img src="${originalImageUrl}" alt="ÂéüÂßãÂõæÁâá" class="preview-image"></div>
                            <div class="preview-image-item"><h4>ÁøªËØëÂêéÂõæÁâá</h4><img src="${translatedImageUrl}" alt="ÁøªËØëÂêéÂõæÁâá" class="preview-image"></div>
                        </div>`;
                }
            }
            
            detailsContent = generateDetailsContent(result);
            showDownloadButtons(result);
            
            // Êõ¥Êñ∞UI
            resultPreview.innerHTML = previewContent || '<div class="preview-placeholder"><h3>Êó†ÂèØÁî®È¢ÑËßà</h3></div>';
            resultDetails.innerHTML = detailsContent;
            showStatusMessage('ÁøªËØëÂÆåÊàêÔºÅ', 'success');

        } catch (error) {
            // Áªü‰∏ÄÁöÑÈîôËØØÂ§ÑÁêÜ
            resultPreview.innerHTML = `<div class="preview-placeholder"><div class="placeholder-icon" style="color: #ef4444;">‚ùå</div><div class="placeholder-text"><h3>Â§ÑÁêÜÂ§±Ë¥•</h3><p>${error.message}</p></div></div>`;
            resultDetails.innerHTML = `<div class="details-placeholder"><p>ËØ¶ÁªÜ‰ø°ÊÅØ‰∏çÂèØÁî®</p></div>`;
            showStatusMessage(`Â§ÑÁêÜÂ§±Ë¥•: ${error.message}`, 'error');
            console.error("Display result error:", error);
        }
    }


        // ÊµãËØïPDF URLÁöÑÂèØËÆøÈóÆÊÄß
        async function testPdfUrls(result) {
            try {
                let testUrl = '';
                
                if (currentTranslationType === 'poster' && result.pdf_download_url) {
                    const previewUrl = result.pdf_download_url.replace('/download/poster/', '/preview/poster/');
                    testUrl = `${backendUrl}${previewUrl}`;
                } else if (currentTranslationType.startsWith('webpage') && result.download_url) {
                    let previewUrl;
                    if (currentTranslationType === 'webpage-google') {
                        previewUrl = result.download_url.replace('/download/translated/', '/preview/translated/');
                    } else {
                        previewUrl = result.download_url.replace('/download/workflow/', '/preview/workflow/');
                    }
                    testUrl = `${backendUrl}${previewUrl}`;
                }
                
                if (testUrl) {
                    console.log('ÊµãËØïPDF URL:', testUrl);
                    
                    const response = await fetch(testUrl, { method: 'HEAD' });
                    
                    if (response.ok) {
                        console.log('‚úÖ PDF URLÊµãËØïÊàêÂäü:', response.status);
                        addLogEntry(`PDFÈ¢ÑËßàURLÊµãËØïÊàêÂäü: ${response.status}`, 'success');
                    } else {
                        console.error('‚ùå PDF URLÊµãËØïÂ§±Ë¥•:', response.status, response.statusText);
                        addLogEntry(`PDFÈ¢ÑËßàURLÊµãËØïÂ§±Ë¥•: ${response.status} ${response.statusText}`, 'error');
                    }
                }
            } catch (error) {
                console.error('PDF URLÊµãËØïÂºÇÂ∏∏:', error);
                addLogEntry(`PDFÈ¢ÑËßàURLÊµãËØïÂºÇÂ∏∏: ${error.message}`, 'error');
            }
        }

        function generatePreviewContent(result) {
            switch (currentTranslationType) {
                case 'poster':
                    // Êµ∑Êä•ÁøªËØë - ÊòæÁ§∫ÁºñËØëÂêéÁöÑPDFÁªìÊûú
                    if (result.pdf_generated && result.pdf_download_url) {
                        // Â∞Ü‰∏ãËΩΩURLËΩ¨Êç¢‰∏∫È¢ÑËßàURL
                        const previewUrl = result.pdf_download_url.replace('/download/poster/', '/preview/poster/');
                        const fullPreviewUrl = `${backendUrl}${previewUrl}`;
                        
                        console.log('üîç Êµ∑Êä•PDFÈ¢ÑËßàË∞ÉËØï‰ø°ÊÅØ:');
                        console.log('  - ÂéüÂßã‰∏ãËΩΩURL:', result.pdf_download_url);
                        console.log('  - ËΩ¨Êç¢ÂêéÈ¢ÑËßàURL:', previewUrl);
                        console.log('  - ÂÆåÊï¥È¢ÑËßàURL:', fullPreviewUrl);
                        console.log('  - ÂêéÁ´ØURL:', backendUrl);
                        
                        // È™åËØÅURLÊ†ºÂºè
                        if (!fullPreviewUrl.startsWith('http')) {
                            console.error('‚ùå È¢ÑËßàURLÊ†ºÂºèÈîôËØØ:', fullPreviewUrl);
                        }
                        
                        return `
                            <div class="preview-pdf-container" style="padding: 0; background: #ffffff; position: relative;">
                                <iframe src="${fullPreviewUrl}" 
                                        class="preview-iframe"
                                        title="Êµ∑Êä•ÁøªËØëPDFÈ¢ÑËßà"
                                        onload="handlePdfIframeLoad(this)"
                                        onerror="handlePdfIframeError(this)"
                                        style="opacity: 0; transition: opacity 0.3s ease;">
                                </iframe>
                                <div class="pdf-fallback" style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); text-align: center; color: #64748b; z-index: 1;">
                                    <div style="font-size: 48px; margin-bottom: 15px;">üìÑ</div>
                                    <h3>PDF È¢ÑËßàÂä†ËΩΩ‰∏≠...</h3>
                                    <p>Â¶ÇÊûúÊó†Ê≥ïÊòæÁ§∫È¢ÑËßàÔºåËØ∑ÁÇπÂáª‰∏ãËΩΩÊåâÈíÆ</p>
                                    <p style="font-size: 0.8em; color: #94a3b8; margin-top: 10px;">Ê≠£Âú®Âä†ËΩΩ: ${previewUrl}</p>
                                </div>
                            </div>
                        `;
                    } else {
                        return `
                            <div class="preview-pdf-container">
                                <div style="text-align: center;">
                                    <div style="font-size: 48px; margin-bottom: 15px; color: #ef4444;">‚ùå</div>
                                    <h3>PDF ÁîüÊàêÂ§±Ë¥•</h3>
                                    <p>LaTeX ‰ª£Á†ÅÂ∑≤ÁîüÊàêÔºå‰ΩÜ PDF ÁºñËØëÂ§±Ë¥•</p>
                                    ${result.pdf_message ? `<p style="margin-top: 10px; color: #ef4444; font-size: 0.9em;">${result.pdf_message}</p>` : ''}
                                </div>
                            </div>
                        `;
                    }

                case 'webpage-gpt':
                case 'webpage-google':
                    // ÁΩëÈ°µÁøªËØë - ÊòæÁ§∫ÁøªËØëÂêéÁöÑPDFÂÜÖÂÆπ
                    if (result.download_url) {
                        // Ê†πÊçÆÁøªËØëÁ±ªÂûãÁ°ÆÂÆöÈ¢ÑËßàURL
                        let previewUrl;
                        if (currentTranslationType === 'webpage-google') {
                            previewUrl = result.download_url.replace('/download/translated/', '/preview/translated/');
                        } else {
                            previewUrl = result.download_url.replace('/download/workflow/', '/preview/workflow/');
                        }
                        
                        const fullPreviewUrl = `${backendUrl}${previewUrl}`;
                        
                        console.log('üîç ÁΩëÈ°µPDFÈ¢ÑËßàË∞ÉËØï‰ø°ÊÅØ:');
                        console.log('  - ÂéüÂßã‰∏ãËΩΩURL:', result.download_url);
                        console.log('  - ËΩ¨Êç¢ÂêéÈ¢ÑËßàURL:', previewUrl);
                        console.log('  - ÂÆåÊï¥È¢ÑËßàURL:', fullPreviewUrl);
                        console.log('  - ÂêéÁ´ØURL:', backendUrl);
                        console.log('  - ÂΩìÂâçÁøªËØëÁ±ªÂûã:', currentTranslationType);
                        
                        // È™åËØÅURLÊ†ºÂºè
                        if (!fullPreviewUrl.startsWith('http')) {
                            console.error('‚ùå È¢ÑËßàURLÊ†ºÂºèÈîôËØØ:', fullPreviewUrl);
                        }
                        
                        return `
                            <div class="preview-pdf-container" style="padding: 0; background: #ffffff; position: relative;">
                                <iframe src="${fullPreviewUrl}" 
                                        class="preview-iframe"
                                        title="ÁΩëÈ°µÁøªËØëPDFÈ¢ÑËßà"
                                        onload="handlePdfIframeLoad(this)"
                                        onerror="handlePdfIframeError(this)"
                                        style="opacity: 0; transition: opacity 0.3s ease;">
                                </iframe>
                                <div class="pdf-fallback" style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); text-align: center; color: #64748b; z-index: 1;">
                                    <div style="font-size: 48px; margin-bottom: 15px;">üåê</div>
                                    <h3>PDF È¢ÑËßàÂä†ËΩΩ‰∏≠...</h3>
                                    <p>Êñá‰ª∂Â§ßÂ∞è: ${(result.file_size / 1024).toFixed(2)} KB</p>
                                    <p style="font-size: 0.8em; margin-top: 5px;">Â¶ÇÊûúÊó†Ê≥ïÊòæÁ§∫È¢ÑËßàÔºåËØ∑ÁÇπÂáª‰∏ãËΩΩÊåâÈíÆ</p>
                                    <p style="font-size: 0.7em; color: #94a3b8; margin-top: 5px;">Ê≠£Âú®Âä†ËΩΩ: ${previewUrl}</p>
                                </div>
                            </div>
                        `;
                    } else {
                        return `
                            <div class="preview-pdf-container">
                                <div style="text-align: center;">
                                    <div style="font-size: 48px; margin-bottom: 15px; color: #ef4444;">‚ùå</div>
                                    <h3>PDF ÁîüÊàêÂ§±Ë¥•</h3>
                                    <p>ÁΩëÈ°µÁøªËØëËøáÁ®ã‰∏≠Âá∫Áé∞ÈóÆÈ¢ò</p>
                                </div>
                            </div>
                        `;
                    }

                case 'baidu-image':
                    // ÂõæÁâáÁøªËØë - ÊòæÁ§∫ÂéüÂõæ‰∏éÁøªËØëÂêéÂõæÁâáÁöÑÂØπÊØîÈ¢ÑËßà
                    if (result.has_translated_image && result.download_url) {
                        const containerId = `image-container-${Date.now()}`;
                        return `
                            <div id="${containerId}" class="preview-image-container horizontal">
                                <div class="preview-image-item">
                                    <h4>ÂéüÂßãÂõæÁâá</h4>
                                    <img id="${containerId}-original" 
                                         src="${result.original_image_url ? backendUrl + result.original_image_url : 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjE1MCIgdmlld0JveD0iMCAwIDIwMCAxNTAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIyMDAiIGhlaWdodD0iMTUwIiBmaWxsPSIjRjNGNEY2Ii8+Cjx0ZXh0IHg9IjEwMCIgeT0iNzUiIGZvbnQtZmFtaWx5PSJBcmlhbCIgZm9udC1zaXplPSIxNCIgZmlsbD0iIzlDQTNBRiIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZG9taW5hbnQtYmFzZWxpbmU9Im1pZGRsZSI+5Y6f5aeL5Zu+54mH</dGV4dD4KPHN2Zz4K'}" 
                                         alt="ÂéüÂßãÂõæÁâá" class="preview-image" 
                                         onload="optimizeImageLayout('${containerId}')"
                                         onerror="this.src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjE1MCIgdmlld0JveD0iMCAwIDIwMCAxNTAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIyMDAiIGhlaWdodD0iMTUwIiBmaWxsPSIjRjNGNEY2Ii8+Cjx0ZXh0IHg9IjEwMCIgeT0iNzUiIGZvbnQtZmFtaWx5PSJBcmlhbCIgZm9udC1zaXplPSIxNCIgZmlsbD0iIzlDQTNBRiIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZG9taW5hbnQtYmFzZWxpbmU9Im1pZGRsZSI+5Zu+54mH5LiN5Y+v55So</dGV4dD4KPHN2Zz4K'">
                                </div>
                                <div class="preview-image-item">
                                    <h4>ÁøªËØëÂêéÂõæÁâá</h4>
                                    <img id="${containerId}-translated" 
                                         src="${backendUrl}${result.download_url}" 
                                         alt="ÁøªËØëÂêéÂõæÁâá" class="preview-image"
                                         onload="optimizeImageLayout('${containerId}')"
                                         onerror="this.src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjE1MCIgdmlld0JveD0iMCAwIDIwMCAxNTAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIyMDAiIGhlaWdodD0iMTUwIiBmaWxsPSIjRUZGNkZGIi8+Cjx0ZXh0IHg9IjEwMCIgeT0iNzUiIGZvbnQtZmFtaWx5PSJBcmlhbCIgZm9udC1zaXplPSIxNCIgZmlsbD0iIzEwQjk4MSIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZG9taW5hbnQtYmFzZWxpbmU9Im1pZGRsZSI+57+76K+R5ZCO5Zu+54mH</dGV4dD4KPHN2Zz4K'">
                                </div>
                            </div>
                        `;
                    } else {
                        return `
                            <div class="preview-pdf-container">
                                <div style="text-align: center;">
                                    <div style="font-size: 48px; margin-bottom: 15px;">üñºÔ∏è</div>
                                    <h3>ÂõæÁâáÁøªËØëÂÆåÊàê</h3>
                                    <p>Ê£ÄÊµãÂà∞ÁöÑÊñáÊú¨Â∑≤ÊàêÂäüÁøªËØë</p>
                                    ${result.text_info && result.text_info.summary_dst ? 
                                        `<div style="margin-top: 15px; padding: 15px; background: rgba(59, 130, 246, 0.1); border-radius: 8px; border-left: 4px solid #3b82f6;">
                                            <h4 style="color: #3b82f6; margin-bottom: 8px; font-size: 0.9em;">ÁøªËØëÁªìÊûú:</h4>
                                            <p style="color: #f1f5f9; line-height: 1.5; margin: 0;">${result.text_info.summary_dst}</p>
                                        </div>` : ''}
                                </div>
                            </div>
                        `;
                    }

                default:
                    return `
                        <div class="preview-placeholder">
                            <div class="placeholder-icon">‚úÖ</div>
                            <div class="placeholder-text">
                                <h3>ÁøªËØëÂÆåÊàê</h3>
                                <p>ËØ∑Êü•Áúã‰∏ãÊñπËØ¶ÊÉÖÂπ∂‰∏ãËΩΩÁªìÊûú</p>
                            </div>
                        </div>
                    `;
            }
        }

        function generateDetailsContent(result) {
            switch (currentTranslationType) {
                case 'poster':
                    return `
                        <div class="result-content">
                            <div class="result-item">
                                <h4>Êµ∑Êä•ÁøªËØëÁªìÊûú</h4>
                                <p><strong>LaTeXÁîüÊàê:</strong> <span class="${result.latex_generated ? 'success' : 'error'}">${result.latex_generated ? 'ÊàêÂäü' : 'Â§±Ë¥•'}</span></p>
                                <p><strong>PDFÁîüÊàê:</strong> <span class="${result.pdf_generated ? 'success' : 'error'}">${result.pdf_generated ? 'ÊàêÂäü' : 'Â§±Ë¥•'}</span></p>
                                ${result.pdf_message ? `<p><strong>Ê∂àÊÅØ:</strong> ${result.pdf_message}</p>` : ''}
                                <p><strong>LaTeXÊñá‰ª∂:</strong> ${result.tex_filename}</p>
                                ${result.pdf_filename ? `<p><strong>PDFÊñá‰ª∂:</strong> ${result.pdf_filename}</p>` : ''}
                                <p><strong>‰ª£Á†ÅÈïøÂ∫¶:</strong> ${result.latex_code_length} Â≠óÁ¨¶</p>
                            </div>
                        </div>
                    `;

                case 'webpage-gpt':
                    return `
                        <div class="result-content">
                            <div class="result-item">
                                <h4>GPTÁΩëÈ°µÁøªËØëÁªìÊûú</h4>
                                <p><strong>ÂéüÂßãÈìæÊé•:</strong> <a href="${result.original_url}" target="_blank" style="color: #3b82f6;">${result.original_url}</a></p>
                                <p><strong>Áä∂ÊÄÅ:</strong> <span class="success">ÁøªËØëÊàêÂäü</span></p>
                                <p><strong>ÁøªËØëPDF:</strong> ${result.pdf_filename}</p>
                                <p><strong>Êñá‰ª∂Â§ßÂ∞è:</strong> ${(result.file_size / 1024).toFixed(2)} KB</p>
                                <p><strong>Â¢ûÂº∫ÂäüËÉΩ:</strong> 
                                    <span style="color: #10b981;">90% Áº©Êîæ</span> | 
                                    <span style="color: #10b981;">Ëá™Âä®ÈáçËØï</span> | 
                                    <span style="color: #10b981;">ËØ¶ÁªÜÊó•Âøó</span>
                                </p>
                            </div>
                        </div>
                    `;

                case 'webpage-google':
                    return `
                        <div class="result-content">
                            <div class="result-item">
                                <h4>Á®≥ÂÆöÁâàÁΩëÈ°µÁøªËØëÁªìÊûú</h4>
                                <p><strong>ÂéüÂßãÈìæÊé•:</strong> <a href="${result.original_url}" target="_blank" style="color: #3b82f6;">${result.original_url}</a></p>
                                <p><strong>Áä∂ÊÄÅ:</strong> <span class="success">ÁøªËØëÊàêÂäü</span></p>
                                <p><strong>ÁøªËØëPDF:</strong> ${result.pdf_filename}</p>
                                <p><strong>Êñá‰ª∂Â§ßÂ∞è:</strong> ${(result.file_size / 1024).toFixed(2)} KB</p>
                            </div>
                        </div>
                    `;

                case 'baidu-image':
                    return `
                        <div class="result-content">
                            <div class="result-item">
                                <h4>ÂõæÁâáÁøªËØëÁªìÊûú</h4>
                                <p><strong>ÁøªËØëÊñπÂêë:</strong> ${result.translation_direction}</p>
                                <p><strong>Áä∂ÊÄÅ:</strong> <span class="success">ÁøªËØëÊàêÂäü</span></p>
                                ${result.has_translated_image ? `<p><strong>ÁøªËØëÂõæÁâá:</strong> ${result.translated_filename}</p>` : ''}
                                ${result.file_size ? `<p><strong>Êñá‰ª∂Â§ßÂ∞è:</strong> ${(result.file_size / 1024).toFixed(2)} KB</p>` : ''}
                                ${result.text_info && result.text_info.summary_src ? `<p><strong>Ê£ÄÊµãÂà∞ÁöÑÊñáÊú¨:</strong> ${result.text_info.summary_src}</p>` : ''}
                                ${result.text_info && result.text_info.summary_dst ? `<p><strong>ÁøªËØëÊñáÊú¨:</strong> ${result.text_info.summary_dst}</p>` : ''}
                                ${result.text_info && result.text_info.detected_texts && result.text_info.detected_texts.length > 0 ? 
                                    `<p><strong>ÊñáÊú¨ÂùóÊï∞Èáè:</strong> ${result.text_info.detected_texts.length} ‰∏™</p>` : ''}
                            </div>
                        </div>
                    `;

                default:
                    return `
                        <div class="details-placeholder">
                            <p>Â§ÑÁêÜÂÆåÊàêÔºåËØ¶ÁªÜ‰ø°ÊÅØ‰∏çÂèØÁî®</p>
                        </div>
                    `;
            }
        }

        function showDownloadButtons(result) {
            // ÈöêËóèÊâÄÊúâ‰∏ãËΩΩÊåâÈíÆ
            document.querySelectorAll('.download-btn').forEach(btn => btn.style.display = 'none');



            switch (currentTranslationType) {
                case 'poster':
                    if (result.pdf_generated && result.pdf_download_url) {
                        document.getElementById('download-main-btn').textContent = '‰∏ãËΩΩÁøªËØëPDF';
                        document.getElementById('download-main-btn').style.display = 'block';
                    }
                    break;

                case 'webpage-gpt':
                case 'webpage-google':
                    if (result.download_url) {
                        document.getElementById('download-main-btn').textContent = '‰∏ãËΩΩÁøªËØëPDF';
                        document.getElementById('download-main-btn').style.display = 'block';
                    }
                    break;

                case 'baidu-image':
                    if (result.has_translated_image && result.download_url) {
                        document.getElementById('download-main-btn').textContent = '‰∏ãËΩΩÁøªËØëÂõæÁâá';
                        document.getElementById('download-main-btn').style.display = 'block';
                    }
                    break;
            }


        }

        function downloadMain() {
            if (!translationResult) return;
            
            let downloadUrl = '';
            let filename = '';
            let fileType = '';
            
            switch (currentTranslationType) {
                case 'poster':
                    downloadUrl = translationResult.pdf_download_url;
                    filename = translationResult.pdf_filename;
                    fileType = 'PDFÊñá‰ª∂';
                    break;
                case 'webpage-gpt':
                case 'webpage-google':
                    downloadUrl = translationResult.download_url;
                    filename = translationResult.pdf_filename;
                    fileType = 'PDFÊñá‰ª∂';
                    break;
                case 'baidu-image':
                    downloadUrl = translationResult.download_url;
                    filename = translationResult.translated_filename;
                    fileType = 'ÁøªËØëÂõæÁâá';
                    break;
            }
            
            if (downloadUrl) {
                addLogEntry(`ÂºÄÂßã‰∏ãËΩΩ${fileType}: ${filename}`, 'info');
                window.open(`${backendUrl}${downloadUrl}`, '_blank');
                showStatusMessage('Êñá‰ª∂‰∏ãËΩΩÂ∑≤ÂºÄÂßã', 'success');
            }
        }

        // PDF iframeÂ§ÑÁêÜÂáΩÊï∞
        function handlePdfIframeLoad(iframe) {
            console.log('üîÑ PDF iframe Âä†ËΩΩ‰∫ã‰ª∂Ëß¶Âèë');
            console.log('  - ÂΩìÂâçsrc:', iframe.src);
            console.log('  - iframeÁä∂ÊÄÅ:', iframe.readyState);
            
            // Ê£ÄÊü•iframeÊòØÂê¶ÊåáÂêë‰∫ÜÈîôËØØÁöÑURL
            if (iframe.src === `${backendUrl}/` || iframe.src === backendUrl || iframe.src === 'about:blank') {
                console.error('‚ùå iframeË¢´ÈáçÂÆöÂêëÂà∞ÈîôËØØÁöÑURL:', iframe.src);
                handlePdfIframeError(iframe);
                return;
            }
            
            // Ê£ÄÊü•ÊòØÂê¶ÊòØPDFÈ¢ÑËßàURL
            if (!iframe.src.includes('/preview/')) {
                console.error('‚ùå iframe URL‰∏çÊòØÈ¢ÑËßàURL:', iframe.src);
                handlePdfIframeError(iframe);
                return;
            }
            
            // Âª∂Ëøü‰∏ÄÁÇπÊó∂Èó¥ÂÜçÊòæÁ§∫ÔºåÁ°Æ‰øùPDFÁúüÊ≠£Âä†ËΩΩÂÆåÊàê
            setTimeout(() => {
                iframe.style.opacity = '1';
                
                // ÈöêËóèÂä†ËΩΩÊèêÁ§∫
                const fallback = iframe.parentElement.querySelector('.pdf-fallback');
                if (fallback) {
                    fallback.style.display = 'none';
                }
                
                console.log('‚úÖ PDFÈ¢ÑËßàÊòæÁ§∫ÊàêÂäü');
            }, 500);
        }

        function handlePdfIframeError(iframe) {
            console.error('PDF iframe Âä†ËΩΩÂ§±Ë¥•, src:', iframe.src);
            iframe.style.opacity = '0';
            
            // Â∞ùËØïÂ§áÁî®È¢ÑËßàÊñπÊ°à
            if (tryAlternativePdfPreview(iframe)) {
                console.log('Â∞ùËØï‰ΩøÁî®Â§áÁî®PDFÈ¢ÑËßàÊñπÊ°à');
                return;
            }
            
            // ÊòæÁ§∫ÈîôËØØÊèêÁ§∫
            const fallback = iframe.parentElement.querySelector('.pdf-fallback');
            if (fallback) {
                fallback.style.display = 'block';
                fallback.innerHTML = `
                    <div style="font-size: 48px; margin-bottom: 15px; color: #ef4444;">‚ö†Ô∏è</div>
                    <h3>PDF È¢ÑËßà‰∏çÂèØÁî®</h3>
                    <p>ÂèØËÉΩÁöÑÂéüÂõ†Ôºö</p>
                    <ul style="text-align: left; font-size: 0.9em; margin: 10px 0;">
                        <li>ÊµèËßàÂô®‰∏çÊîØÊåÅPDFÈ¢ÑËßà</li>
                        <li>PDFÊñá‰ª∂ÊçüÂùèÊàñ‰∏çÂ≠òÂú®</li>
                        <li>ÁΩëÁªúËøûÊé•ÈóÆÈ¢ò</li>
                    </ul>
                    <p style="font-size: 0.9em; margin-top: 15px; color: #3b82f6;">üí° Âª∫ËÆÆÁÇπÂáª‰∏ãÊñπ‰∏ãËΩΩÊåâÈíÆËé∑ÂèñPDFÊñá‰ª∂</p>
                    <button onclick="window.open('${iframe.src}', '_blank')" style="margin-top: 10px; padding: 8px 16px; background: #3b82f6; color: white; border: none; border-radius: 4px; cursor: pointer;">
                        Âú®Êñ∞Ê†áÁ≠æÈ°µ‰∏≠ÊâìÂºÄPDF
                    </button>
                    <button onclick="tryReloadPdfIframe('${iframe.src}')" style="margin-left: 10px; margin-top: 10px; padding: 8px 16px; background: #10b981; color: white; border: none; border-radius: 4px; cursor: pointer;">
                        ÈáçÊñ∞Âä†ËΩΩÈ¢ÑËßà
                    </button>
                    <button onclick="testPdfInfrastructure()" style="margin-left: 10px; margin-top: 10px; padding: 8px 16px; background: #8b5cf6; color: white; border: none; border-radius: 4px; cursor: pointer;">
                        ÊµãËØïÈ¢ÑËßàÂäüËÉΩ
                    </button>
                `;
            }
        }

        // Â∞ùËØïÂ§áÁî®PDFÈ¢ÑËßàÊñπÊ°à
        function tryAlternativePdfPreview(iframe) {
            try {
                const container = iframe.parentElement;
                const pdfUrl = iframe.src;
                
                // ÂàõÂª∫objectÂÖÉÁ¥†‰Ωú‰∏∫Â§áÁî®
                const objectElement = document.createElement('object');
                objectElement.data = pdfUrl;
                objectElement.type = 'application/pdf';
                objectElement.style.width = '100%';
                objectElement.style.height = '100%';
                objectElement.style.border = 'none';
                
                // Ê∑ªÂä†Â§±Ë¥•ÂõûË∞É
                objectElement.onerror = function() {
                    console.error('Â§áÁî®PDFÈ¢ÑËßàÊñπÊ°à‰πüÂ§±Ë¥•‰∫Ü');
                    return false;
                };
                
                // ÊõøÊç¢iframe
                container.removeChild(iframe);
                container.appendChild(objectElement);
                
                console.log('Â∑≤ÂàáÊç¢Âà∞objectÂÖÉÁ¥†È¢ÑËßàPDF');
                return true;
                
            } catch (error) {
                console.error('Â§áÁî®PDFÈ¢ÑËßàÊñπÊ°àÂ§±Ë¥•:', error);
                return false;
            }
        }

        // Ê£ÄÊµãiframeÊòØÂê¶ÁúüÊ≠£Âä†ËΩΩ‰∫ÜPDFÂÜÖÂÆπ
        function checkIframeContent(iframe) {
            try {
                // Ê£ÄÊü•iframeÊòØÂê¶ÊàêÂäüÂä†ËΩΩ
                if (iframe.contentWindow && iframe.contentWindow.location.href === 'about:blank') {
                    console.warn('iframeÂÜÖÂÆπ‰∏∫Á©∫ÁôΩÈ°µÈù¢');
                    handlePdfIframeError(iframe);
                    return false;
                }
                
                // Ê£ÄÊü•ÂìçÂ∫îÁä∂ÊÄÅ
                fetch(iframe.src)
                    .then(response => {
                        if (!response.ok) {
                            console.error('PDFÊñá‰ª∂ËØ∑Ê±ÇÂ§±Ë¥•:', response.status, response.statusText);
                            handlePdfIframeError(iframe);
                        } else {
                            console.log('PDFÊñá‰ª∂ËØ∑Ê±ÇÊàêÂäü:', response.status);
                        }
                    })
                    .catch(error => {
                        console.error('PDFÊñá‰ª∂Ê£ÄÊü•Â§±Ë¥•:', error);
                        handlePdfIframeError(iframe);
                    });
                
                return true;
            } catch (e) {
                console.error('Ê£ÄÊü•iframeÂÜÖÂÆπÊó∂Âá∫Èîô:', e);
                return false;
            }
        }

        // Ê£ÄÊü•ÊµèËßàÂô®PDFÊîØÊåÅ
        function checkPdfSupport() {
            // Ê£ÄÊü•ÊµèËßàÂô®ÊòØÂê¶ÊîØÊåÅPDFÂµåÂÖ•
            const pdfPluginSupported = navigator.mimeTypes && navigator.mimeTypes['application/pdf'];
            const chromeWithPdfViewer = navigator.userAgent.indexOf('Chrome') > -1;
            const firefoxWithPdfViewer = navigator.userAgent.indexOf('Firefox') > -1;
            
            return pdfPluginSupported || chromeWithPdfViewer || firefoxWithPdfViewer;
        }

        // Ë∞ÉËØïÂäüËÉΩÔºöËé∑ÂèñÂèØÁî®PDFÊñá‰ª∂ÂàóË°®
        async function debugPdfFiles() {
            try {
                const response = await fetch(`${backendUrl}/api/debug/pdf-files`);
                const result = await response.json();
                
                console.log('üìÅ ÂèØÁî®PDFÊñá‰ª∂:', result);
                
                if (result.success) {
                    let debugInfo = 'üìÅ ÂèØÁî®PDFÊñá‰ª∂ÂàóË°®:\n';
                    
                    if (result.files.poster && result.files.poster.length > 0) {
                        debugInfo += `\nüé® Êµ∑Êä•Êñá‰ª∂ (${result.files.poster.length}‰∏™):\n`;
                        result.files.poster.forEach(file => {
                            debugInfo += `  - ${file}\n`;
                            debugInfo += `    È¢ÑËßà: ${backendUrl}/preview/poster/${file}\n`;
                        });
                    }
                    
                    if (result.files.translated && result.files.translated.length > 0) {
                        debugInfo += `\nüåê GoogleÁøªËØëÊñá‰ª∂ (${result.files.translated.length}‰∏™):\n`;
                        result.files.translated.forEach(file => {
                            debugInfo += `  - ${file}\n`;
                            debugInfo += `    È¢ÑËßà: ${backendUrl}/preview/translated/${file}\n`;
                        });
                    }
                    
                    if (result.files.workflow && Object.keys(result.files.workflow).length > 0) {
                        debugInfo += `\nüîÑ Â∑•‰ΩúÊµÅÁ®ãÊñá‰ª∂:\n`;
                        Object.keys(result.files.workflow).forEach(folder => {
                            debugInfo += `  üìÇ ${folder}:\n`;
                            result.files.workflow[folder].forEach(file => {
                                debugInfo += `    - ${file}\n`;
                                debugInfo += `      È¢ÑËßà: ${backendUrl}/preview/workflow/${folder}/${file}\n`;
                            });
                        });
                    }
                    
                    console.log(debugInfo);
                    addLogEntry('PDFÊñá‰ª∂ÂàóË°®Â∑≤Âú®ÊéßÂà∂Âè∞ÊòæÁ§∫', 'info');
                } else {
                    console.error('Ëé∑ÂèñPDFÊñá‰ª∂ÂàóË°®Â§±Ë¥•:', result.error);
                    addLogEntry(`Ëé∑ÂèñPDFÊñá‰ª∂ÂàóË°®Â§±Ë¥•: ${result.error}`, 'error');
                }
                
            } catch (error) {
                console.error('Ë∞ÉËØïÂäüËÉΩÂºÇÂ∏∏:', error);
                addLogEntry(`Ë∞ÉËØïÂäüËÉΩÂºÇÂ∏∏: ${error.message}`, 'error');
            }
        }

        // ÂÖ®Â±ÄÊö¥Èú≤Ë∞ÉËØïÂáΩÊï∞ÔºàÂºÄÂèëÊó∂‰ΩøÁî®Ôºâ
        window.debugPdfFiles = debugPdfFiles;
        window.testPdfPreview = function(url) {
            window.open(url, '_blank');
        };
        window.detectScreenSize = detectScreenSize;
        window.applyAdaptiveLayout = applyAdaptiveLayout;
        window.testCurrentPdf = function() {
            if (!translationResult) {
                console.log('‚ùå ÂΩìÂâçÊ≤°ÊúâÁøªËØëÁªìÊûú');
                return;
            }
            
            let previewUrl = '';
            
            if (currentTranslationType === 'poster' && translationResult.pdf_download_url) {
                previewUrl = translationResult.pdf_download_url.replace('/download/poster/', '/preview/poster/');
            } else if (currentTranslationType.startsWith('webpage') && translationResult.download_url) {
                if (currentTranslationType === 'webpage-google') {
                    previewUrl = translationResult.download_url.replace('/download/translated/', '/preview/translated/');
                } else {
                    previewUrl = translationResult.download_url.replace('/download/workflow/', '/preview/workflow/');
                }
            }
            
            if (previewUrl) {
                const fullUrl = `${backendUrl}${previewUrl}`;
                console.log('üîç ÊµãËØïÂΩìÂâçPDFÈ¢ÑËßàURL:', fullUrl);
                window.open(fullUrl, '_blank');
            } else {
                console.log('‚ùå ÂΩìÂâçÁøªËØëÁªìÊûúÊ≤°ÊúâPDFÊñá‰ª∂');
            }
        };
        
        // ÈáçÊñ∞Âä†ËΩΩPDF iframe
        window.tryReloadPdfIframe = function(pdfUrl) {
            console.log('üîÑ Â∞ùËØïÈáçÊñ∞Âä†ËΩΩPDFÈ¢ÑËßà:', pdfUrl);
            
            // Êü•ÊâæÂΩìÂâçÁöÑPDFÂÆπÂô®
            const pdfContainers = document.querySelectorAll('.preview-pdf-container');
            
            pdfContainers.forEach(container => {
                const iframe = container.querySelector('iframe');
                if (iframe && (iframe.src === pdfUrl || iframe.src.includes('/preview/'))) {
                    console.log('ÊâæÂà∞ÂåπÈÖçÁöÑiframeÔºåÈáçÊñ∞Âä†ËΩΩ...');
                    
                    // ÈáçÁΩÆiframe
                    iframe.style.opacity = '0';
                    
                    // ÊòæÁ§∫Âä†ËΩΩÁä∂ÊÄÅ
                    const fallback = container.querySelector('.pdf-fallback');
                    if (fallback) {
                        fallback.style.display = 'block';
                        fallback.innerHTML = `
                            <div style="font-size: 48px; margin-bottom: 15px;">üîÑ</div>
                            <h3>ÈáçÊñ∞Âä†ËΩΩPDFÈ¢ÑËßà...</h3>
                            <p>Ê≠£Âú®Â∞ùËØïÈáçÊñ∞Âä†ËΩΩÈ¢ÑËßàÂÜÖÂÆπ</p>
                        `;
                    }
                    
                    // Âª∂ËøüÈáçÊñ∞ËÆæÁΩÆsrc
                    setTimeout(() => {
                        iframe.src = pdfUrl;
                        console.log('iframe srcÂ∑≤ÈáçÊñ∞ËÆæÁΩÆ‰∏∫:', pdfUrl);
                    }, 1000);
                }
            });
        };

        // ÊµãËØïPDFÈ¢ÑËßàÂäüËÉΩÂü∫Á°ÄËÆæÊñΩ
        window.testPdfInfrastructure = function() {
            console.log('üß™ ÂºÄÂßãÊµãËØïPDFÈ¢ÑËßàÂü∫Á°ÄËÆæÊñΩ...');
            
            // ÊµãËØïÂü∫Êú¨ÁöÑiframeÂäüËÉΩ
            const testUrl = `${backendUrl}/api/test/pdf-preview`;
            console.log('ÊµãËØïURL:', testUrl);
            
            // ÂàõÂª∫ÊµãËØïiframe
            const testContainer = document.createElement('div');
            testContainer.style.cssText = `
                position: fixed; top: 50px; right: 50px; width: 400px; height: 300px;
                background: white; border: 2px solid #3b82f6; border-radius: 8px;
                z-index: 10000; box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            `;
            
            testContainer.innerHTML = `
                <div style="padding: 10px; background: #3b82f6; color: white; font-weight: bold;">
                    PDFÈ¢ÑËßàÂäüËÉΩÊµãËØï
                    <button onclick="this.parentElement.parentElement.remove()" 
                            style="float: right; background: none; border: none; color: white; cursor: pointer;">‚úï</button>
                </div>
                <iframe src="${testUrl}" style="width: 100%; height: calc(100% - 40px); border: none;"></iframe>
            `;
            
            document.body.appendChild(testContainer);
            
            // 5ÁßíÂêéËá™Âä®ÂÖ≥Èó≠
            setTimeout(() => {
                if (testContainer.parentElement) {
                    testContainer.remove();
                    console.log('‚úÖ PDFÈ¢ÑËßàÂäüËÉΩÊµãËØïÂÆåÊàê');
                }
            }, 5000);
        };

        // ÂõæÁâáÂ∏ÉÂ±Ä‰ºòÂåñÂáΩÊï∞
        function optimizeImageLayout(containerId) {
            try {
                const container = document.getElementById(containerId);
                if (!container) return;
                
                const originalImg = document.getElementById(`${containerId}-original`);
                const translatedImg = document.getElementById(`${containerId}-translated`);
                
                // Á≠âÂæÖ‰∏§Âº†ÂõæÁâáÈÉΩÂä†ËΩΩÂÆåÊàê
                if (!originalImg || !translatedImg || !originalImg.complete || !translatedImg.complete) {
                    // Â¶ÇÊûúÊúâÂõæÁâáËøòÊ≤°Âä†ËΩΩÂÆåÔºåÁ®çÂêéÂÜçËØï
                    setTimeout(() => optimizeImageLayout(containerId), 100);
                    return;
                }
                
                // Ëé∑ÂèñÂÆπÂô®Â∞∫ÂØ∏
                const containerRect = container.getBoundingClientRect();
                const containerWidth = containerRect.width - 30; // ÂáèÂéªpadding
                const containerHeight = containerRect.height - 30;
                
                // Ëé∑ÂèñÂõæÁâáÂéüÂßãÂ∞∫ÂØ∏
                const img1Width = originalImg.naturalWidth || originalImg.width;
                const img1Height = originalImg.naturalHeight || originalImg.height;
                const img2Width = translatedImg.naturalWidth || translatedImg.width;
                const img2Height = translatedImg.naturalHeight || translatedImg.height;
                
                console.log(`ÂÆπÂô®Â∞∫ÂØ∏: ${containerWidth} x ${containerHeight}`);
                console.log(`ÂéüÂõæÂ∞∫ÂØ∏: ${img1Width} x ${img1Height}`);
                console.log(`ÁøªËØëÂõæÂ∞∫ÂØ∏: ${img2Width} x ${img2Height}`);
                
                if (img1Width === 0 || img1Height === 0 || img2Width === 0 || img2Height === 0) {
                    console.log('ÂõæÁâáÂ∞∫ÂØ∏Êó†ÊïàÔºå‰ΩøÁî®ÈªòËÆ§Â∏ÉÂ±Ä');
                    return;
                }
                
                // ËÆ°ÁÆóÂõæÁâáÁöÑÈïøÂÆΩÊØî
                const img1Ratio = img1Width / img1Height;
                const img2Ratio = img2Width / img2Height;
                const containerRatio = containerWidth / containerHeight;
                
                // ËÆ°ÁÆó‰∏§ÁßçÂ∏ÉÂ±ÄÊñπÊ°àÁöÑÁ©∫Èó¥Âà©Áî®Áéá
                let horizontalUtilization = 0;
                let verticalUtilization = 0;
                
                // Ê∞¥Âπ≥ÊéíÂàóÊó∂ÁöÑËÆ°ÁÆó
                const horizontalAvailableWidth = containerWidth / 2 - 7.5; // ÂáèÂéªgapÁöÑ‰∏ÄÂçä
                const horizontalImg1Scale = Math.min(
                    horizontalAvailableWidth / img1Width,
                    containerHeight / img1Height
                );
                const horizontalImg2Scale = Math.min(
                    horizontalAvailableWidth / img2Width,
                    containerHeight / img2Height
                );
                horizontalUtilization = (
                    (img1Width * horizontalImg1Scale) + (img2Width * horizontalImg2Scale) + 15
                ) / containerWidth;
                
                // ÂûÇÁõ¥ÊéíÂàóÊó∂ÁöÑËÆ°ÁÆó
                const verticalAvailableHeight = containerHeight / 2 - 30; // ÂáèÂéªÊ†áÈ¢òÂíågap
                const verticalImg1Scale = Math.min(
                    containerWidth / img1Width,
                    verticalAvailableHeight / img1Height
                );
                const verticalImg2Scale = Math.min(
                    containerWidth / img2Width,
                    verticalAvailableHeight / img2Height
                );
                verticalUtilization = Math.max(
                    (img1Height * verticalImg1Scale + 30) / containerHeight,
                    (img2Height * verticalImg2Scale + 30) / containerHeight
                );
                
                console.log(`Ê∞¥Âπ≥Â∏ÉÂ±ÄÂà©Áî®Áéá: ${horizontalUtilization.toFixed(3)}`);
                console.log(`ÂûÇÁõ¥Â∏ÉÂ±ÄÂà©Áî®Áéá: ${verticalUtilization.toFixed(3)}`);
                
                // ÈÄâÊã©Á©∫Èó¥Âà©Áî®ÁéáÊõ¥È´òÁöÑÂ∏ÉÂ±Ä
                const useHorizontal = horizontalUtilization >= verticalUtilization;
                
                // Â∫îÁî®Â∏ÉÂ±Ä
                container.className = `preview-image-container ${useHorizontal ? 'horizontal' : 'vertical'}`;
                
                console.log(`ÈÄâÊã©${useHorizontal ? 'Ê∞¥Âπ≥' : 'ÂûÇÁõ¥'}Â∏ÉÂ±Ä`);
                
                // Âº∫Âà∂ÈáçÊñ∞Â∏ÉÂ±Ä
                setTimeout(() => {
                    container.style.display = 'none';
                    container.offsetHeight; // Ëß¶ÂèëÈáçÊéí
                    container.style.display = 'flex';
                }, 10);
                
            } catch (error) {
                console.error('Â∏ÉÂ±Ä‰ºòÂåñÂ§±Ë¥•:', error);
            }
        }

        // Ê∑ªÂä†ÈîôËØØÂ§ÑÁêÜ
        window.addEventListener('error', function(e) {
            hideLoading();
            addLogEntry(`Â∫îÁî®Á®ãÂ∫èÈîôËØØ: ${e.error?.message || e.message}`, 'error');
            showStatusMessage('ÂèëÁîü‰∫Ü‰∏Ä‰∏™ÈîôËØØÔºåËØ∑Ê£ÄÊü•ÊéßÂà∂Âè∞', 'error');
            console.error('Application error:', e.error);
        });
    </script>
</body>
</html>